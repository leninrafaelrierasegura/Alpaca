<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Alpaca</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
<link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa-solid fa-clipboard\" style=\"color: #00008B\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Alpaca</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="info.html">Rankings - from April 23, 2025</a>
</li>
<li>
  <a href="xnfo.html">Rankings - from August 07, 2025</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/leninrafaelrierasegura/Alpaca">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Alpaca</h1>
<h4 class="date">27-01-2026.</h4>

</div>


<style type="text/css">
body .main-container {
  max-width: 100% !important;
  width: 100% !important;
}
body {
  max-width: 100% !important;
}

body, td {
   font-size: 16px;
}
code.r{
  font-size: 14px;
}
pre {
  font-size: 14px
}
.custom-box {
  background-color: #f5f7fa; /* Light grey-blue background */
  border-color: #e1e8ed; /* Light border color */
  color: #2c3e50; /* Dark text color */
  padding: 15px; /* Padding inside the box */
  border-radius: 5px; /* Rounded corners */
  margin-bottom: 20px; /* Spacing below the box */
}
.caption {
  margin: auto;
  text-align: center;
  margin-bottom: 20px; /* Spacing below the box */
}
</style>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Set global options for all code chunks</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="co"># Disable messages printed by R code chunks</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,    </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="co"># Disable warnings printed by R code chunks</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,    </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="co"># Show R code within code chunks in output</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="co"># Include both R code and its results in output</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">include =</span> <span class="cn">TRUE</span>,     </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="co"># Evaluate R code chunks</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">eval =</span> <span class="cn">TRUE</span>,       </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="co"># Enable caching of R code chunks for faster rendering</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="at">cache =</span> <span class="cn">FALSE</span>,      </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="co"># Align figures in the center of the output</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="co"># Enable retina display for high-resolution figures</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="at">retina =</span> <span class="dv">2</span>,</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="co"># Show errors in the output instead of stopping rendering</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="at">error =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="co"># Do not collapse code and output into a single block</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="at">collapse =</span> <span class="cn">FALSE</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co"># Start the figure counter</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>fig_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="co"># Define the captioner function</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>captioner <span class="ot">&lt;-</span> <span class="cf">function</span>(caption) {</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  fig_count <span class="ot">&lt;&lt;-</span> fig_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;Figure &quot;</span>, fig_count, <span class="st">&quot;: &quot;</span>, caption)</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>}</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="co"># Define the function to truncate a number to two decimal places</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>truncate_to_two <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>  <span class="fu">floor</span>(x <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">library</span>(zoo) <span class="co"># to use na.locf</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">library</span>(tidyr) <span class="co"># to use pivot_wider</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">library</span>(slackr)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">library</span>(grateful)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">library</span>(DT) </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>initial_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2025-04-23&quot;</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">&quot;keys.R&quot;</span>))</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">slackr_setup</span>(<span class="at">token =</span> token)</span></code></pre></div>
<pre><code>## Error in curl::curl_fetch_memory(url, handle = handle): Timeout was reached [slack.com]: Resolving timed out after 10000 milliseconds</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>format_market_cap <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">sapply</span>(x, <span class="cf">function</span>(val) {</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.na</span>(val)) {</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>      <span class="fu">return</span>(<span class="st">&quot;NA&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    }</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    val <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(val)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="sc">&gt;=</span> <span class="fl">1e12</span>) {</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%.1fT&quot;</span>, val <span class="sc">/</span> <span class="fl">1e12</span>))</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (val <span class="sc">&gt;=</span> <span class="fl">1e9</span>) {</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%.1fB&quot;</span>, val <span class="sc">/</span> <span class="fl">1e9</span>))</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (val <span class="sc">&gt;=</span> <span class="fl">1e6</span>) {</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%.1fM&quot;</span>, val <span class="sc">/</span> <span class="fl">1e6</span>))</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (val <span class="sc">&gt;=</span> <span class="fl">1e3</span>) {</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%.1fk&quot;</span>, val <span class="sc">/</span> <span class="fl">1e3</span>))</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">as.character</span>(val))</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>    }</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  })</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>}</span></code></pre></div>
<div id="data-description" class="section level1">
<h1>Data description</h1>
<p>Data is downloaded daily from <a
href="https://www.nasdaq.com/market-activity/stocks/screener">here</a>.
The <code>lastsale</code> value reported in the previous link is the
open price when the market closes, according to this <a
href="https://finance.yahoo.com/">website</a>.</p>
<p>Data collection started on April 23, 2025.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>aux_day <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>day_of_week <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(aux_day)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="cf">if</span> (day_of_week <span class="sc">==</span> <span class="st">&quot;Monday&quot;</span>) {</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  today <span class="ot">&lt;-</span> aux_day <span class="sc">-</span> <span class="dv">3</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (day_of_week <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Tuesday&quot;</span>, <span class="st">&quot;Wednesday&quot;</span>, <span class="st">&quot;Thursday&quot;</span>, <span class="st">&quot;Friday&quot;</span>)) {</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  today <span class="ot">&lt;-</span> aux_day <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  today <span class="ot">&lt;-</span> aux_day  <span class="co"># or handle Saturday/Sunday however you want</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>}</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co"># Define the API URL</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://api.nasdaq.com/api/screener/stocks?tableonly=true&amp;limit=25&amp;offset=0&amp;download=true&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co"># Set headers to mimic a browser</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>headers <span class="ot">&lt;-</span> <span class="fu">add_headers</span>(<span class="st">`</span><span class="at">User-Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Mozilla/5.0&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co"># Send GET request</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">GET</span>(url, headers)</span></code></pre></div>
<pre><code>## Error in curl::curl_fetch_memory(url, handle = handle): Timeout was reached [api.nasdaq.com]: Resolving timed out after 10000 milliseconds</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Check status</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">status_code</span>(response) <span class="sc">==</span> <span class="dv">200</span>) {</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="co"># Parse JSON content</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  content_json <span class="ot">&lt;-</span> <span class="fu">content</span>(response, <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  data_list <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(content_json, <span class="at">flatten =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="co"># Extract rows from JSON</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  stock_data <span class="ot">&lt;-</span> data_list<span class="sc">$</span>data<span class="sc">$</span>rows</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="co"># Add current date column</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  stock_data<span class="sc">$</span>date <span class="ot">&lt;-</span> today</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="co"># Create filename with today&#39;s date</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  file_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;nasdaq_screener_&quot;</span>, today, <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  <span class="co"># Save to CSV</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>  <span class="fu">write_csv</span>(stock_data, <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, file_name))</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;✅ Data saved to&quot;</span>, file_name, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;❌ Failed to fetch data. Status code:&quot;</span>, <span class="fu">status_code</span>(response), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error: object &#39;response&#39; not found</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># The following line should replace the next following line</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>today_stock_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, file_name))  <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">nchar</span>(symbol)<span class="sc">&lt;</span><span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="co"># filter out stocks with more than 4 characters (not tradeable)</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">^&quot;</span>, symbol)) <span class="sc">|&gt;</span> <span class="co"># remove symbols containing ^</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>url, <span class="sc">-</span>netchange, <span class="sc">-</span>pctchange) <span class="sc">|&gt;</span> <span class="co"># remove unnecessary columns</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lastsale =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;[$,]&quot;</span>, <span class="st">&quot;&quot;</span>, lastsale))) <span class="sc">|&gt;</span><span class="co"># remove $ and , from lastsale and make it numeric</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="fu">select</span>(symbol, date, lastsale, <span class="fu">everything</span>()) <span class="co"># reorder columns</span></span></code></pre></div>
<pre><code>## Error: object &#39;file_name&#39; not found</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Remove symbols that are not longer being traded</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>cummulative_stock_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">&quot;data/cummulative_stock_data.RDS&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">filter</span>(symbol <span class="sc">%in%</span> today_stock_data<span class="sc">$</span>symbol)</span></code></pre></div>
<pre><code>## Error in `filter()`:
## ℹ In argument: `symbol %in% today_stock_data$symbol`.
## Caused by error:
## ! object &#39;today_stock_data&#39; not found</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># The following two instructions deals with new_data being added when it is already there.</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># This might happen when the stock market is closed during weekdays</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Keep only rows from today_stock_data that are NOT already in cummulative_stock_data</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>new_today_stock_data <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(today_stock_data, </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                                  cummulative_stock_data, </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(today_stock_data), <span class="st">&quot;date&quot;</span>)) <span class="co"># Identify columns to match (everything except &#39;date&#39;)</span></span></code></pre></div>
<pre><code>## Error: object &#39;today_stock_data&#39; not found</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>clean_cummulative_stock_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cummulative_stock_data, new_today_stock_data) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">arrange</span>(symbol, date) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">select</span>(symbol, date, lastsale, marketCap, country, industry, sector, ipoyear, volume, name)</span></code></pre></div>
<pre><code>## Error: object &#39;cummulative_stock_data&#39; not found</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Get unique dates from the dataset</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>unique_dates <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(clean_cummulative_stock_data<span class="sc">$</span>date))</span></code></pre></div>
<pre><code>## Error: object &#39;clean_cummulative_stock_data&#39; not found</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Step 1: Expand each symbol to all existing dates</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>stock_data_expanded <span class="ot">&lt;-</span> clean_cummulative_stock_data <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">complete</span>(<span class="at">date =</span> unique_dates) <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## Error: object &#39;clean_cummulative_stock_data&#39; not found</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Step 2: Fill backward for multiple columns</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>columns_to_fill <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="st">&quot;lastsale&quot;</span>, <span class="st">&quot;marketCap&quot;</span>, <span class="st">&quot;country&quot;</span>, <span class="st">&quot;industry&quot;</span>, </span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="st">&quot;sector&quot;</span>, <span class="st">&quot;ipoyear&quot;</span>, <span class="st">&quot;volume&quot;</span>, <span class="st">&quot;name&quot;</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>stock_data_filled <span class="ot">&lt;-</span> stock_data_expanded <span class="sc">|&gt;</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="fu">arrange</span>(date, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(columns_to_fill),</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>                <span class="sc">~</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(.x, <span class="at">fromLast =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))) <span class="sc">|&gt;</span> <span class="co"># filling from the last available value backward</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(columns_to_fill),</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>                <span class="sc">~</span> zoo<span class="sc">::</span><span class="fu">na.locf</span>(.x, <span class="at">fromLast =</span> <span class="cn">FALSE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>))) <span class="sc">|&gt;</span> <span class="co"># filling from the first available value forward</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="fu">arrange</span>(symbol, date)</span></code></pre></div>
<pre><code>## Error: object &#39;stock_data_expanded&#39; not found</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>stock_data_to_save <span class="ot">&lt;-</span> stock_data_filled <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">arrange</span>(date, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(lastsale))) <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="fu">arrange</span>(symbol, date)</span></code></pre></div>
<pre><code>## Error: object &#39;stock_data_filled&#39; not found</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">saveRDS</span>(stock_data_to_save, <span class="fu">here</span>(<span class="st">&quot;data/cummulative_stock_data.RDS&quot;</span>))</span></code></pre></div>
<pre><code>## Error: object &#39;stock_data_to_save&#39; not found</code></pre>
</div>
<div id="filters" class="section level1">
<h1>Filters</h1>
<p>Let <code>X_k(t_i)</code> denote the value of a stock
<code>X_k</code> at day <code>t_i</code>, where <code>i= 0,...,N</code>.
Let <code>pct X_k(t_i)</code> denote the percentage change of
<code>X_k(t_i)</code> with respect to <code>X_k(t_0)</code>, i.e.,
<code>pct X_k(t_i) = (X_k(t_i) - X_k(t_0))/X_k(t_0) * 100</code>. For
each stock <code>X_k</code>, the filters are as follows:</p>
<ul>
<li><p>The first filter is that <code>X_k(t_0) &lt;= X_k(t_N)</code>,
i.e., the stock must have a positive growth trend within the period of
analysis.</p></li>
<li><p>The second filter is that
<code>0.8*X_k(t_{i-1}) &lt;= X_k(t_i) &lt;= 2*X_k(t_{i-1})</code>, i.e.,
the next day price is at most twice and at least 80% of the last price
(from day to day it can only fall 20%).</p></li>
<li><p>The third filter is that
<code>max{ pct X_k(t_0), ..., pct X_k(t_{N-1})} / 2 &lt;= pct X_k(t_N)</code>,
i.e., the final price growth is at least half of the highest
growth.</p></li>
<li><p>The fourth filter is that
<code>min{|pct X_k(t_0)|, ..., |pct X_k(t_{N-1})|} &lt;= pct X_k(t_N)</code>,
i.e., the stock must not have fallen more than what it has
grown.</p></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># stock_data_to_save &lt;- readRDS(here(&quot;data/cummulative_stock_data.RDS&quot;))</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>stocks_data_with_comment_column <span class="ot">&lt;-</span> stock_data_to_save <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comment =</span> <span class="cn">NA_character_</span>)</span></code></pre></div>
<pre><code>## Error: object &#39;stock_data_to_save&#39; not found</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># The following ensures that we only keep stocks that have a positive growth trend</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>stocks_data_grow <span class="ot">&lt;-</span> stocks_data_with_comment_column <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="fu">arrange</span>(date, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comment =</span> <span class="fu">if_else</span>(</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>    <span class="fu">is.na</span>(comment) <span class="sc">&amp;</span> <span class="sc">!</span>(<span class="fu">first</span>(lastsale) <span class="sc">&lt;=</span> <span class="fu">last</span>(lastsale)), </span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>    <span class="st">&quot;did not pass X(t_0) &lt;= X(t_N)&quot;</span>, </span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    comment</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## Error: object &#39;stocks_data_with_comment_column&#39; not found</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># The following ensures that the next day price is at most twice and at least 80% of the last price (from day to day it can only fall 20%)</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>stocks_data_window <span class="ot">&lt;-</span> stocks_data_grow <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">arrange</span>(date, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>    <span class="at">comment =</span> <span class="fu">if_else</span>(</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>      <span class="fu">is.na</span>(comment) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">all</span>((<span class="fu">lead</span>(lastsale) <span class="sc">&gt;</span> <span class="fl">0.8</span> <span class="sc">*</span> lastsale) <span class="sc">&amp;</span> (<span class="fu">lead</span>(lastsale) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">*</span> lastsale), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>      <span class="st">&quot;did not pass 0.8*X(t_{i-1}) &lt;= X(t_i) &lt;= 2*X(t_{i-1})&quot;</span>, </span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>      comment</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>    )) <span class="sc">|&gt;</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## Error: object &#39;stocks_data_grow&#39; not found</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Compute the percentage change from the start date (daily and accumulated)</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co"># Keep only those stocks where the final price growth is at least half of the highest growth (before the end).</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>stock_data_pct_change <span class="ot">&lt;-</span> stocks_data_window <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  <span class="fu">arrange</span>(date, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">daily_pct_change =</span> (lastsale <span class="sc">-</span> <span class="fu">lag</span>(lastsale)) <span class="sc">/</span> <span class="fu">lag</span>(lastsale) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>         <span class="at">accum_pct_change =</span> (lastsale <span class="sc">-</span> <span class="fu">first</span>(lastsale)) <span class="sc">/</span> <span class="fu">first</span>(lastsale) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comment =</span> <span class="fu">if_else</span>(</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>    <span class="fu">is.na</span>(comment) <span class="sc">&amp;</span> <span class="sc">!</span>((<span class="fu">max</span>(<span class="fu">head</span>(accum_pct_change, <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">&lt;=</span> <span class="fu">last</span>(accum_pct_change)),</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>    <span class="st">&quot;did not pass max{pct X(t_0), ..., pct X(t_{N-1})} / 2 &lt;= pct X(t_N)&quot;</span>, </span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>    comment</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code></pre></div>
<pre><code>## Error: object &#39;stocks_data_window&#39; not found</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># Filter symbols that have fallen (anytime) more that what they have grown (at the end)</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>stock_data_pct_change_that_grow <span class="ot">&lt;-</span> stock_data_pct_change <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="fu">arrange</span>(date, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>    <span class="at">comment =</span> <span class="fu">if_else</span>(</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>      <span class="fu">is.na</span>(comment) <span class="sc">&amp;</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>      <span class="fu">any</span>(accum_pct_change <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">&amp;</span> <span class="sc">!</span>(<span class="fu">abs</span>(<span class="fu">min</span>(<span class="fu">head</span>(accum_pct_change, <span class="sc">-</span><span class="dv">1</span>))) <span class="sc">&lt;=</span> <span class="fu">last</span>(accum_pct_change)),</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>      <span class="st">&quot;did not pass min{|pct X(t_0)|, ..., |pct X(t_{N-1})|} &lt;= pct X(t_N)&quot;</span>,</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>      comment</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>    )</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## Error: object &#39;stock_data_pct_change&#39; not found</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># Removes the first date (the one that was used to compute the daily percentage change)</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>aux <span class="ot">&lt;-</span> stock_data_pct_change_that_grow <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">!=</span> <span class="fu">min</span>(date))</span></code></pre></div>
<pre><code>## Error: object &#39;stock_data_pct_change_that_grow&#39; not found</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>AUX_to_rank <span class="ot">&lt;-</span> aux <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(comment))</span></code></pre></div>
<pre><code>## Error: object &#39;aux&#39; not found</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># From here on there are no more filters</span></span></code></pre></div>
</div>
<div id="rankings" class="section level1">
<h1>Rankings</h1>
<p>Let <code>R_j</code> be the rank of the stocks according to their
percentage change <code>pct X_k(t_i)</code> at day <code>t_i</code>. The
ranks is computed as follows:</p>
<ul>
<li><p><code>Accumulated rank</code>. More complicated than the others.
The idea is to compute the rank of each stock at each date, and then
accumulate the ranks according to the following logic:</p>
<ul>
<li>If <code>R_j(t_i) &gt;= R_j(t_{i-1})</code>, then
<code>R_j(t_i) = R_j(t_{i-1}) + R_j(t_i)</code>.</li>
<li>If <code>R_j(t_i) &lt; R_j(t_{i-1})</code>, then
<code>R_j(t_i) = R_j(t_{i-1}) - R_j(t_i)</code>.</li>
</ul>
<p>This means that if a stock has a better rank than the previous day,
its accumulated rank increases by the value of its current rank. If it
has a worse rank, its accumulated rank decreases by the value of its
current rank.</p></li>
<li><p><code>Sum of ranks</code>. This is simply
<code>R_1 + R_2 + ... + R_N</code>.</p></li>
<li><p><code>Last day rank</code>. This is simply
<code>R_N</code>.</p></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># The following contains the information of the surviving symbols</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>info_of_surviving_symbols <span class="ot">&lt;-</span> aux <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">max</span>(date)) <span class="sc">|&gt;</span> <span class="co"># so we get the last market cap and volume, for example</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date, <span class="sc">-</span>daily_pct_change) <span class="sc">|&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">marketCap_ =</span> <span class="fu">format_market_cap</span>(marketCap),</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>         <span class="at">accum_pct_change =</span> <span class="fu">round</span>(accum_pct_change, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Error: object &#39;aux&#39; not found</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># The following is the list of symbols that passed all filters</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>info_of_those_that_passed_all_filters <span class="ot">&lt;-</span> info_of_surviving_symbols <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(comment)) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>comment)</span></code></pre></div>
<pre><code>## Error: object &#39;info_of_surviving_symbols&#39; not found</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># The following is the list of symbols that did not pass all filters</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>reason_for_those_that_did_not_pass_all_filters <span class="ot">&lt;-</span> info_of_surviving_symbols <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comment)) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  <span class="fu">select</span>(symbol, comment)</span></code></pre></div>
<pre><code>## Error: object &#39;info_of_surviving_symbols&#39; not found</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># Compute the rank for each date</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>aux_ranked <span class="ot">&lt;-</span> AUX_to_rank <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="fu">arrange</span>(accum_pct_change) <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>  <span class="fu">arrange</span>(symbol,date)</span></code></pre></div>
<pre><code>## Error: object &#39;AUX_to_rank&#39; not found</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Compute last day rank</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>last_day_rank <span class="ot">&lt;-</span> aux_ranked <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">max</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">last_rank =</span> rank) <span class="sc">|&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(last_rank))</span></code></pre></div>
<pre><code>## Error: object &#39;aux_ranked&#39; not found</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># Compute the sum of ranks </span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>sum_rank <span class="ot">&lt;-</span> aux_ranked <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  <span class="fu">group_by</span>(symbol) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_rank =</span> <span class="fu">sum</span>(rank)) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(sum_rank))</span></code></pre></div>
<pre><code>## Error: object &#39;aux_ranked&#39; not found</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Create the table of ranks</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>table_of_ranks <span class="ot">&lt;-</span> aux_ranked <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  <span class="fu">select</span>(symbol, date, rank) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>    <span class="at">names_from =</span> date,</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>    <span class="at">values_from =</span> rank</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Error: object &#39;aux_ranked&#39; not found</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># assume first column is &#39;symbol&#39;</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>ranking_accumulated <span class="ot">&lt;-</span> table_of_ranks</span></code></pre></div>
<pre><code>## Error: object &#39;table_of_ranks&#39; not found</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co"># Get only the numeric part (the ranks)</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>rank_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(table_of_ranks[,<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>## Error: object &#39;table_of_ranks&#39; not found</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># Apply the custom accumulation logic row-wise</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>accumulated_matrix <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(rank_matrix, <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  acc <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(row))</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  acc[<span class="dv">1</span>] <span class="ot">&lt;-</span> row[<span class="dv">1</span>]</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(row)) {</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>    <span class="cf">if</span> (row[i] <span class="sc">&gt;=</span> row[i <span class="sc">-</span> <span class="dv">1</span>]) {</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>      acc[i] <span class="ot">&lt;-</span> acc[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> row[i]</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>      acc[i] <span class="ot">&lt;-</span> acc[i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">-</span> row[i]</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>    }</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>  }</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  <span class="fu">return</span>(acc)</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>}))</span></code></pre></div>
<pre><code>## Error: object &#39;rank_matrix&#39; not found</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># Combine with symbols again</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>ranking_accumulated[,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> accumulated_matrix</span></code></pre></div>
<pre><code>## Error: object &#39;accumulated_matrix&#39; not found</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>acc_rank <span class="ot">&lt;-</span> ranking_accumulated[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">ncol</span>(ranking_accumulated))] <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">acc_rank =</span> <span class="fu">colnames</span>(ranking_accumulated)[<span class="fu">ncol</span>(ranking_accumulated)]) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(acc_rank))</span></code></pre></div>
<pre><code>## Error: object &#39;ranking_accumulated&#39; not found</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># Augment the ranks with info</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>aug_acc_rank <span class="ot">&lt;-</span> acc_rank <span class="sc">|&gt;</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  <span class="fu">inner_join</span>(info_of_those_that_passed_all_filters, <span class="at">by =</span> <span class="st">&quot;symbol&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(acc_rank)) <span class="sc">|&gt;</span></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  <span class="fu">select</span>(symbol, acc_rank, marketCap, marketCap_, accum_pct_change, country, industry, sector, ipoyear, volume, lastsale, name) <span class="sc">|&gt;</span></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">symbol =</span> <span class="fu">paste0</span>(<span class="st">&quot;&lt;a href=&#39;https://finance.yahoo.com/quote/&quot;</span>, symbol, <span class="st">&quot;&#39; target=&#39;_blank&#39;&gt;&quot;</span>, symbol, <span class="st">&quot;&lt;/a&gt;&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>  <span class="fu">select</span>(symbol, acc_rank, marketCap, marketCap_, accum_pct_change, country, industry, sector, ipoyear, volume, rank, lastsale, name)</span></code></pre></div>
<pre><code>## Error: object &#39;acc_rank&#39; not found</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>aug_sum_rank <span class="ot">&lt;-</span> sum_rank <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(info_of_those_that_passed_all_filters, <span class="at">by =</span> <span class="st">&quot;symbol&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(sum_rank)) <span class="sc">|&gt;</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  <span class="fu">select</span>(symbol, sum_rank, marketCap, marketCap_, accum_pct_change, country, industry, sector, ipoyear, volume, lastsale, name) <span class="sc">|&gt;</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">symbol =</span> <span class="fu">paste0</span>(<span class="st">&quot;&lt;a href=&#39;https://finance.yahoo.com/quote/&quot;</span>, symbol, <span class="st">&quot;&#39; target=&#39;_blank&#39;&gt;&quot;</span>, symbol, <span class="st">&quot;&lt;/a&gt;&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>  <span class="fu">select</span>(symbol, sum_rank, marketCap, marketCap_, accum_pct_change, country, industry, sector, ipoyear, volume, rank, lastsale, name)</span></code></pre></div>
<pre><code>## Error: object &#39;sum_rank&#39; not found</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>aug_last_day_rank <span class="ot">&lt;-</span> last_day_rank <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(info_of_those_that_passed_all_filters, <span class="at">by =</span> <span class="st">&quot;symbol&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(last_rank)) <span class="sc">|&gt;</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>  <span class="fu">select</span>(symbol, last_rank, marketCap, marketCap_, accum_pct_change, country, industry, sector, ipoyear, volume, lastsale, name) <span class="sc">|&gt;</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">symbol =</span> <span class="fu">paste0</span>(<span class="st">&quot;&lt;a href=&#39;https://finance.yahoo.com/quote/&quot;</span>, symbol, <span class="st">&quot;&#39; target=&#39;_blank&#39;&gt;&quot;</span>, symbol, <span class="st">&quot;&lt;/a&gt;&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>  <span class="fu">select</span>(symbol, last_rank, marketCap, marketCap_, accum_pct_change, country, industry, sector, ipoyear, volume, rank, lastsale, name)</span></code></pre></div>
<pre><code>## Error: object &#39;last_day_rank&#39; not found</code></pre>
<hr />
</div>
<div id="accumulated-rank" class="section level1">
<h1>Accumulated Rank</h1>
<hr />
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  aug_acc_rank,</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">&#39;lrtip&#39;</span>,</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>    <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>  <span class="st">&quot;function(settings) {&quot;</span>,</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>  <span class="st">&quot;  var api = this.api();&quot;</span>,</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>  <span class="st">&quot;  var header = $(api.table().header());&quot;</span>,</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>  <span class="st">&quot;  var filterRow = $(&#39;&lt;tr&gt;&#39;).appendTo(header);&quot;</span>,</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>  <span class="st">&quot;  var colIndices = { country: 5, industry: 6, sector: 7, ipoyear: 8 };&quot;</span>,</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>  <span class="st">&quot;  var industryToSector = {};&quot;</span>,</span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>  <span class="st">&quot;  // First pass: build industry-to-sector map&quot;</span>,</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>  <span class="st">&quot;  var allData = api.rows().data();&quot;</span>,</span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>  <span class="st">&quot;  allData.each(function(row) {&quot;</span>,</span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a>  <span class="st">&quot;    var industry = row[colIndices.industry];&quot;</span>,</span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a>  <span class="st">&quot;    var sector = row[colIndices.sector];&quot;</span>,</span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a>  <span class="st">&quot;    if (industry &amp;&amp; sector) {&quot;</span>,</span>
<span id="cb72-23"><a href="#cb72-23" tabindex="-1"></a>  <span class="st">&quot;      industryToSector[industry] = sector;&quot;</span>,</span>
<span id="cb72-24"><a href="#cb72-24" tabindex="-1"></a>  <span class="st">&quot;    }&quot;</span>,</span>
<span id="cb72-25"><a href="#cb72-25" tabindex="-1"></a>  <span class="st">&quot;  });&quot;</span>,</span>
<span id="cb72-26"><a href="#cb72-26" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" tabindex="-1"></a>  <span class="st">&quot;  api.columns().every(function(index) {&quot;</span>,</span>
<span id="cb72-28"><a href="#cb72-28" tabindex="-1"></a>  <span class="st">&quot;    var column = this;&quot;</span>,</span>
<span id="cb72-29"><a href="#cb72-29" tabindex="-1"></a>  <span class="st">&quot;    var cell = $(&#39;&lt;th&gt;&#39;).appendTo(filterRow);&quot;</span>,</span>
<span id="cb72-30"><a href="#cb72-30" tabindex="-1"></a></span>
<span id="cb72-31"><a href="#cb72-31" tabindex="-1"></a>  <span class="st">&quot;    if ([colIndices.country, colIndices.industry, colIndices.sector, colIndices.ipoyear].includes(index)) {&quot;</span>,</span>
<span id="cb72-32"><a href="#cb72-32" tabindex="-1"></a>  <span class="st">&quot;      var select = $(&#39;&lt;select&gt;&lt;option value=</span><span class="sc">\&quot;\&quot;</span><span class="st">&gt;&lt;/option&gt;&lt;/select&gt;&#39;)&quot;</span>,</span>
<span id="cb72-33"><a href="#cb72-33" tabindex="-1"></a>  <span class="st">&quot;        .appendTo(cell)&quot;</span>,</span>
<span id="cb72-34"><a href="#cb72-34" tabindex="-1"></a>  <span class="st">&quot;        .on(&#39;change&#39;, function() {&quot;</span>,</span>
<span id="cb72-35"><a href="#cb72-35" tabindex="-1"></a>  <span class="st">&quot;          var val = $.fn.dataTable.util.escapeRegex($(this).val());&quot;</span>,</span>
<span id="cb72-36"><a href="#cb72-36" tabindex="-1"></a>  <span class="st">&quot;          column.search(val ? &#39;^&#39; + val + &#39;$&#39; : &#39;&#39;, true, false).draw();&quot;</span>,</span>
<span id="cb72-37"><a href="#cb72-37" tabindex="-1"></a></span>
<span id="cb72-38"><a href="#cb72-38" tabindex="-1"></a>  <span class="st">&quot;          if (index === colIndices.sector) {&quot;</span>,</span>
<span id="cb72-39"><a href="#cb72-39" tabindex="-1"></a>  <span class="st">&quot;            var selectedSector = $(this).val();&quot;</span>,</span>
<span id="cb72-40"><a href="#cb72-40" tabindex="-1"></a>  <span class="st">&quot;            var industrySelect = filterRow.find(&#39;th&#39;).eq(colIndices.industry).find(&#39;select&#39;);&quot;</span>,</span>
<span id="cb72-41"><a href="#cb72-41" tabindex="-1"></a>  <span class="st">&quot;            industrySelect.val(&#39;&#39;); // clear selection&quot;</span>,</span>
<span id="cb72-42"><a href="#cb72-42" tabindex="-1"></a>  <span class="st">&quot;            industrySelect.empty().append(&#39;&lt;option value=</span><span class="sc">\&quot;\&quot;</span><span class="st">&gt;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb72-43"><a href="#cb72-43" tabindex="-1"></a>  <span class="st">&quot;            var industries = Object.keys(industryToSector).filter(function(ind) {&quot;</span>,</span>
<span id="cb72-44"><a href="#cb72-44" tabindex="-1"></a>  <span class="st">&quot;              return selectedSector === &#39;&#39; || industryToSector[ind] === selectedSector;&quot;</span>,</span>
<span id="cb72-45"><a href="#cb72-45" tabindex="-1"></a>  <span class="st">&quot;            }).sort();&quot;</span>,</span>
<span id="cb72-46"><a href="#cb72-46" tabindex="-1"></a>  <span class="st">&quot;            industries.forEach(function(ind) {&quot;</span>,</span>
<span id="cb72-47"><a href="#cb72-47" tabindex="-1"></a>  <span class="st">&quot;              industrySelect.append(&#39;&lt;option value=</span><span class="sc">\&quot;</span><span class="st">&#39; + ind + &#39;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39; + ind + &#39;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb72-48"><a href="#cb72-48" tabindex="-1"></a>  <span class="st">&quot;            });&quot;</span>,</span>
<span id="cb72-49"><a href="#cb72-49" tabindex="-1"></a>  <span class="st">&quot;            // Also clear industry filter when sector is reset&quot;</span>,</span>
<span id="cb72-50"><a href="#cb72-50" tabindex="-1"></a>  <span class="st">&quot;            var industryColumn = api.column(colIndices.industry);&quot;</span>,</span>
<span id="cb72-51"><a href="#cb72-51" tabindex="-1"></a>  <span class="st">&quot;            industryColumn.search(&#39;&#39;, true, false).draw();&quot;</span>,</span>
<span id="cb72-52"><a href="#cb72-52" tabindex="-1"></a>  <span class="st">&quot;          }&quot;</span>,</span>
<span id="cb72-53"><a href="#cb72-53" tabindex="-1"></a>  <span class="st">&quot;        });&quot;</span>,</span>
<span id="cb72-54"><a href="#cb72-54" tabindex="-1"></a></span>
<span id="cb72-55"><a href="#cb72-55" tabindex="-1"></a>  <span class="st">&quot;      column.data().unique().sort().each(function(d) {&quot;</span>,</span>
<span id="cb72-56"><a href="#cb72-56" tabindex="-1"></a>  <span class="st">&quot;        select.append(&#39;&lt;option value=</span><span class="sc">\&quot;</span><span class="st">&#39; + d + &#39;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39; + d + &#39;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb72-57"><a href="#cb72-57" tabindex="-1"></a>  <span class="st">&quot;      });&quot;</span>,</span>
<span id="cb72-58"><a href="#cb72-58" tabindex="-1"></a>  <span class="st">&quot;    } else if (index === 0) {&quot;</span>,</span>
<span id="cb72-59"><a href="#cb72-59" tabindex="-1"></a>  <span class="st">&quot;      // Add text input for symbol search&quot;</span>,</span>
<span id="cb72-60"><a href="#cb72-60" tabindex="-1"></a>  <span class="st">&quot;      $(&#39;&lt;input type=</span><span class="sc">\&quot;</span><span class="st">text</span><span class="sc">\&quot;</span><span class="st"> placeholder=</span><span class="sc">\&quot;</span><span class="st">Search symbol</span><span class="sc">\&quot;</span><span class="st"> style=</span><span class="sc">\&quot;</span><span class="st">width: 100%;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39;)&quot;</span>,</span>
<span id="cb72-61"><a href="#cb72-61" tabindex="-1"></a>  <span class="st">&quot;        .appendTo(cell)&quot;</span>,</span>
<span id="cb72-62"><a href="#cb72-62" tabindex="-1"></a>  <span class="st">&quot;        .on(&#39;keyup change&#39;, function() {&quot;</span>,</span>
<span id="cb72-63"><a href="#cb72-63" tabindex="-1"></a>  <span class="st">&quot;          var val = $(this).val();&quot;</span>,</span>
<span id="cb72-64"><a href="#cb72-64" tabindex="-1"></a>  <span class="st">&quot;          column.search(val).draw();&quot;</span>,</span>
<span id="cb72-65"><a href="#cb72-65" tabindex="-1"></a>  <span class="st">&quot;        });&quot;</span>,</span>
<span id="cb72-66"><a href="#cb72-66" tabindex="-1"></a>  <span class="st">&quot;    } else {&quot;</span>,</span>
<span id="cb72-67"><a href="#cb72-67" tabindex="-1"></a>  <span class="st">&quot;      $(cell).html(&#39;&#39;);&quot;</span>,</span>
<span id="cb72-68"><a href="#cb72-68" tabindex="-1"></a>  <span class="st">&quot;    }&quot;</span>,</span>
<span id="cb72-69"><a href="#cb72-69" tabindex="-1"></a>  <span class="st">&quot;  });&quot;</span>,</span>
<span id="cb72-70"><a href="#cb72-70" tabindex="-1"></a>  <span class="st">&quot;}&quot;</span></span>
<span id="cb72-71"><a href="#cb72-71" tabindex="-1"></a>)</span>
<span id="cb72-72"><a href="#cb72-72" tabindex="-1"></a>  ),</span>
<span id="cb72-73"><a href="#cb72-73" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb72-74"><a href="#cb72-74" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb72-75"><a href="#cb72-75" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">&quot;display nowrap&quot;</span></span>
<span id="cb72-76"><a href="#cb72-76" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error: object &#39;aug_acc_rank&#39; not found</code></pre>
<hr />
</div>
<div id="sum-of-ranks" class="section level1">
<h1>Sum of Ranks</h1>
<hr />
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>  aug_sum_rank,</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">&#39;lrtip&#39;</span>,</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>    <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  <span class="st">&quot;function(settings) {&quot;</span>,</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>  <span class="st">&quot;  var api = this.api();&quot;</span>,</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>  <span class="st">&quot;  var header = $(api.table().header());&quot;</span>,</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>  <span class="st">&quot;  var filterRow = $(&#39;&lt;tr&gt;&#39;).appendTo(header);&quot;</span>,</span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>  <span class="st">&quot;  var colIndices = { country: 5, industry: 6, sector: 7, ipoyear: 8 };&quot;</span>,</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>  <span class="st">&quot;  var industryToSector = {};&quot;</span>,</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>  <span class="st">&quot;  // First pass: build industry-to-sector map&quot;</span>,</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a>  <span class="st">&quot;  var allData = api.rows().data();&quot;</span>,</span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a>  <span class="st">&quot;  allData.each(function(row) {&quot;</span>,</span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>  <span class="st">&quot;    var industry = row[colIndices.industry];&quot;</span>,</span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>  <span class="st">&quot;    var sector = row[colIndices.sector];&quot;</span>,</span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>  <span class="st">&quot;    if (industry &amp;&amp; sector) {&quot;</span>,</span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a>  <span class="st">&quot;      industryToSector[industry] = sector;&quot;</span>,</span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a>  <span class="st">&quot;    }&quot;</span>,</span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a>  <span class="st">&quot;  });&quot;</span>,</span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a></span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a>  <span class="st">&quot;  api.columns().every(function(index) {&quot;</span>,</span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a>  <span class="st">&quot;    var column = this;&quot;</span>,</span>
<span id="cb74-29"><a href="#cb74-29" tabindex="-1"></a>  <span class="st">&quot;    var cell = $(&#39;&lt;th&gt;&#39;).appendTo(filterRow);&quot;</span>,</span>
<span id="cb74-30"><a href="#cb74-30" tabindex="-1"></a></span>
<span id="cb74-31"><a href="#cb74-31" tabindex="-1"></a>  <span class="st">&quot;    if ([colIndices.country, colIndices.industry, colIndices.sector, colIndices.ipoyear].includes(index)) {&quot;</span>,</span>
<span id="cb74-32"><a href="#cb74-32" tabindex="-1"></a>  <span class="st">&quot;      var select = $(&#39;&lt;select&gt;&lt;option value=</span><span class="sc">\&quot;\&quot;</span><span class="st">&gt;&lt;/option&gt;&lt;/select&gt;&#39;)&quot;</span>,</span>
<span id="cb74-33"><a href="#cb74-33" tabindex="-1"></a>  <span class="st">&quot;        .appendTo(cell)&quot;</span>,</span>
<span id="cb74-34"><a href="#cb74-34" tabindex="-1"></a>  <span class="st">&quot;        .on(&#39;change&#39;, function() {&quot;</span>,</span>
<span id="cb74-35"><a href="#cb74-35" tabindex="-1"></a>  <span class="st">&quot;          var val = $.fn.dataTable.util.escapeRegex($(this).val());&quot;</span>,</span>
<span id="cb74-36"><a href="#cb74-36" tabindex="-1"></a>  <span class="st">&quot;          column.search(val ? &#39;^&#39; + val + &#39;$&#39; : &#39;&#39;, true, false).draw();&quot;</span>,</span>
<span id="cb74-37"><a href="#cb74-37" tabindex="-1"></a></span>
<span id="cb74-38"><a href="#cb74-38" tabindex="-1"></a>  <span class="st">&quot;          if (index === colIndices.sector) {&quot;</span>,</span>
<span id="cb74-39"><a href="#cb74-39" tabindex="-1"></a>  <span class="st">&quot;            var selectedSector = $(this).val();&quot;</span>,</span>
<span id="cb74-40"><a href="#cb74-40" tabindex="-1"></a>  <span class="st">&quot;            var industrySelect = filterRow.find(&#39;th&#39;).eq(colIndices.industry).find(&#39;select&#39;);&quot;</span>,</span>
<span id="cb74-41"><a href="#cb74-41" tabindex="-1"></a>  <span class="st">&quot;            industrySelect.val(&#39;&#39;); // clear selection&quot;</span>,</span>
<span id="cb74-42"><a href="#cb74-42" tabindex="-1"></a>  <span class="st">&quot;            industrySelect.empty().append(&#39;&lt;option value=</span><span class="sc">\&quot;\&quot;</span><span class="st">&gt;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb74-43"><a href="#cb74-43" tabindex="-1"></a>  <span class="st">&quot;            var industries = Object.keys(industryToSector).filter(function(ind) {&quot;</span>,</span>
<span id="cb74-44"><a href="#cb74-44" tabindex="-1"></a>  <span class="st">&quot;              return selectedSector === &#39;&#39; || industryToSector[ind] === selectedSector;&quot;</span>,</span>
<span id="cb74-45"><a href="#cb74-45" tabindex="-1"></a>  <span class="st">&quot;            }).sort();&quot;</span>,</span>
<span id="cb74-46"><a href="#cb74-46" tabindex="-1"></a>  <span class="st">&quot;            industries.forEach(function(ind) {&quot;</span>,</span>
<span id="cb74-47"><a href="#cb74-47" tabindex="-1"></a>  <span class="st">&quot;              industrySelect.append(&#39;&lt;option value=</span><span class="sc">\&quot;</span><span class="st">&#39; + ind + &#39;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39; + ind + &#39;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb74-48"><a href="#cb74-48" tabindex="-1"></a>  <span class="st">&quot;            });&quot;</span>,</span>
<span id="cb74-49"><a href="#cb74-49" tabindex="-1"></a>  <span class="st">&quot;            // Also clear industry filter when sector is reset&quot;</span>,</span>
<span id="cb74-50"><a href="#cb74-50" tabindex="-1"></a>  <span class="st">&quot;            var industryColumn = api.column(colIndices.industry);&quot;</span>,</span>
<span id="cb74-51"><a href="#cb74-51" tabindex="-1"></a>  <span class="st">&quot;            industryColumn.search(&#39;&#39;, true, false).draw();&quot;</span>,</span>
<span id="cb74-52"><a href="#cb74-52" tabindex="-1"></a>  <span class="st">&quot;          }&quot;</span>,</span>
<span id="cb74-53"><a href="#cb74-53" tabindex="-1"></a>  <span class="st">&quot;        });&quot;</span>,</span>
<span id="cb74-54"><a href="#cb74-54" tabindex="-1"></a></span>
<span id="cb74-55"><a href="#cb74-55" tabindex="-1"></a>  <span class="st">&quot;      column.data().unique().sort().each(function(d) {&quot;</span>,</span>
<span id="cb74-56"><a href="#cb74-56" tabindex="-1"></a>  <span class="st">&quot;        select.append(&#39;&lt;option value=</span><span class="sc">\&quot;</span><span class="st">&#39; + d + &#39;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39; + d + &#39;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb74-57"><a href="#cb74-57" tabindex="-1"></a>  <span class="st">&quot;      });&quot;</span>,</span>
<span id="cb74-58"><a href="#cb74-58" tabindex="-1"></a>  <span class="st">&quot;    } else if (index === 0) {&quot;</span>,</span>
<span id="cb74-59"><a href="#cb74-59" tabindex="-1"></a>  <span class="st">&quot;      // Add text input for symbol search&quot;</span>,</span>
<span id="cb74-60"><a href="#cb74-60" tabindex="-1"></a>  <span class="st">&quot;      $(&#39;&lt;input type=</span><span class="sc">\&quot;</span><span class="st">text</span><span class="sc">\&quot;</span><span class="st"> placeholder=</span><span class="sc">\&quot;</span><span class="st">Search symbol</span><span class="sc">\&quot;</span><span class="st"> style=</span><span class="sc">\&quot;</span><span class="st">width: 100%;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39;)&quot;</span>,</span>
<span id="cb74-61"><a href="#cb74-61" tabindex="-1"></a>  <span class="st">&quot;        .appendTo(cell)&quot;</span>,</span>
<span id="cb74-62"><a href="#cb74-62" tabindex="-1"></a>  <span class="st">&quot;        .on(&#39;keyup change&#39;, function() {&quot;</span>,</span>
<span id="cb74-63"><a href="#cb74-63" tabindex="-1"></a>  <span class="st">&quot;          var val = $(this).val();&quot;</span>,</span>
<span id="cb74-64"><a href="#cb74-64" tabindex="-1"></a>  <span class="st">&quot;          column.search(val).draw();&quot;</span>,</span>
<span id="cb74-65"><a href="#cb74-65" tabindex="-1"></a>  <span class="st">&quot;        });&quot;</span>,</span>
<span id="cb74-66"><a href="#cb74-66" tabindex="-1"></a>  <span class="st">&quot;    } else {&quot;</span>,</span>
<span id="cb74-67"><a href="#cb74-67" tabindex="-1"></a>  <span class="st">&quot;      $(cell).html(&#39;&#39;);&quot;</span>,</span>
<span id="cb74-68"><a href="#cb74-68" tabindex="-1"></a>  <span class="st">&quot;    }&quot;</span>,</span>
<span id="cb74-69"><a href="#cb74-69" tabindex="-1"></a>  <span class="st">&quot;  });&quot;</span>,</span>
<span id="cb74-70"><a href="#cb74-70" tabindex="-1"></a>  <span class="st">&quot;}&quot;</span></span>
<span id="cb74-71"><a href="#cb74-71" tabindex="-1"></a>)</span>
<span id="cb74-72"><a href="#cb74-72" tabindex="-1"></a>  ),</span>
<span id="cb74-73"><a href="#cb74-73" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb74-74"><a href="#cb74-74" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb74-75"><a href="#cb74-75" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">&quot;display nowrap&quot;</span></span>
<span id="cb74-76"><a href="#cb74-76" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error: object &#39;aug_sum_rank&#39; not found</code></pre>
<hr />
</div>
<div id="last-day-rank" class="section level1">
<h1>Last Day Rank</h1>
<hr />
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>  aug_last_day_rank,</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">&#39;lrtip&#39;</span>,</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>    <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>  <span class="st">&quot;function(settings) {&quot;</span>,</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>  <span class="st">&quot;  var api = this.api();&quot;</span>,</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>  <span class="st">&quot;  var header = $(api.table().header());&quot;</span>,</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>  <span class="st">&quot;  var filterRow = $(&#39;&lt;tr&gt;&#39;).appendTo(header);&quot;</span>,</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>  <span class="st">&quot;  var colIndices = { country: 5, industry: 6, sector: 7, ipoyear: 8 };&quot;</span>,</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>  <span class="st">&quot;  var industryToSector = {};&quot;</span>,</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>  <span class="st">&quot;  // First pass: build industry-to-sector map&quot;</span>,</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>  <span class="st">&quot;  var allData = api.rows().data();&quot;</span>,</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>  <span class="st">&quot;  allData.each(function(row) {&quot;</span>,</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>  <span class="st">&quot;    var industry = row[colIndices.industry];&quot;</span>,</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>  <span class="st">&quot;    var sector = row[colIndices.sector];&quot;</span>,</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>  <span class="st">&quot;    if (industry &amp;&amp; sector) {&quot;</span>,</span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>  <span class="st">&quot;      industryToSector[industry] = sector;&quot;</span>,</span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>  <span class="st">&quot;    }&quot;</span>,</span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a>  <span class="st">&quot;  });&quot;</span>,</span>
<span id="cb76-26"><a href="#cb76-26" tabindex="-1"></a></span>
<span id="cb76-27"><a href="#cb76-27" tabindex="-1"></a>  <span class="st">&quot;  api.columns().every(function(index) {&quot;</span>,</span>
<span id="cb76-28"><a href="#cb76-28" tabindex="-1"></a>  <span class="st">&quot;    var column = this;&quot;</span>,</span>
<span id="cb76-29"><a href="#cb76-29" tabindex="-1"></a>  <span class="st">&quot;    var cell = $(&#39;&lt;th&gt;&#39;).appendTo(filterRow);&quot;</span>,</span>
<span id="cb76-30"><a href="#cb76-30" tabindex="-1"></a></span>
<span id="cb76-31"><a href="#cb76-31" tabindex="-1"></a>  <span class="st">&quot;    if ([colIndices.country, colIndices.industry, colIndices.sector, colIndices.ipoyear].includes(index)) {&quot;</span>,</span>
<span id="cb76-32"><a href="#cb76-32" tabindex="-1"></a>  <span class="st">&quot;      var select = $(&#39;&lt;select&gt;&lt;option value=</span><span class="sc">\&quot;\&quot;</span><span class="st">&gt;&lt;/option&gt;&lt;/select&gt;&#39;)&quot;</span>,</span>
<span id="cb76-33"><a href="#cb76-33" tabindex="-1"></a>  <span class="st">&quot;        .appendTo(cell)&quot;</span>,</span>
<span id="cb76-34"><a href="#cb76-34" tabindex="-1"></a>  <span class="st">&quot;        .on(&#39;change&#39;, function() {&quot;</span>,</span>
<span id="cb76-35"><a href="#cb76-35" tabindex="-1"></a>  <span class="st">&quot;          var val = $.fn.dataTable.util.escapeRegex($(this).val());&quot;</span>,</span>
<span id="cb76-36"><a href="#cb76-36" tabindex="-1"></a>  <span class="st">&quot;          column.search(val ? &#39;^&#39; + val + &#39;$&#39; : &#39;&#39;, true, false).draw();&quot;</span>,</span>
<span id="cb76-37"><a href="#cb76-37" tabindex="-1"></a></span>
<span id="cb76-38"><a href="#cb76-38" tabindex="-1"></a>  <span class="st">&quot;          if (index === colIndices.sector) {&quot;</span>,</span>
<span id="cb76-39"><a href="#cb76-39" tabindex="-1"></a>  <span class="st">&quot;            var selectedSector = $(this).val();&quot;</span>,</span>
<span id="cb76-40"><a href="#cb76-40" tabindex="-1"></a>  <span class="st">&quot;            var industrySelect = filterRow.find(&#39;th&#39;).eq(colIndices.industry).find(&#39;select&#39;);&quot;</span>,</span>
<span id="cb76-41"><a href="#cb76-41" tabindex="-1"></a>  <span class="st">&quot;            industrySelect.val(&#39;&#39;); // clear selection&quot;</span>,</span>
<span id="cb76-42"><a href="#cb76-42" tabindex="-1"></a>  <span class="st">&quot;            industrySelect.empty().append(&#39;&lt;option value=</span><span class="sc">\&quot;\&quot;</span><span class="st">&gt;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb76-43"><a href="#cb76-43" tabindex="-1"></a>  <span class="st">&quot;            var industries = Object.keys(industryToSector).filter(function(ind) {&quot;</span>,</span>
<span id="cb76-44"><a href="#cb76-44" tabindex="-1"></a>  <span class="st">&quot;              return selectedSector === &#39;&#39; || industryToSector[ind] === selectedSector;&quot;</span>,</span>
<span id="cb76-45"><a href="#cb76-45" tabindex="-1"></a>  <span class="st">&quot;            }).sort();&quot;</span>,</span>
<span id="cb76-46"><a href="#cb76-46" tabindex="-1"></a>  <span class="st">&quot;            industries.forEach(function(ind) {&quot;</span>,</span>
<span id="cb76-47"><a href="#cb76-47" tabindex="-1"></a>  <span class="st">&quot;              industrySelect.append(&#39;&lt;option value=</span><span class="sc">\&quot;</span><span class="st">&#39; + ind + &#39;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39; + ind + &#39;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb76-48"><a href="#cb76-48" tabindex="-1"></a>  <span class="st">&quot;            });&quot;</span>,</span>
<span id="cb76-49"><a href="#cb76-49" tabindex="-1"></a>  <span class="st">&quot;            // Also clear industry filter when sector is reset&quot;</span>,</span>
<span id="cb76-50"><a href="#cb76-50" tabindex="-1"></a>  <span class="st">&quot;            var industryColumn = api.column(colIndices.industry);&quot;</span>,</span>
<span id="cb76-51"><a href="#cb76-51" tabindex="-1"></a>  <span class="st">&quot;            industryColumn.search(&#39;&#39;, true, false).draw();&quot;</span>,</span>
<span id="cb76-52"><a href="#cb76-52" tabindex="-1"></a>  <span class="st">&quot;          }&quot;</span>,</span>
<span id="cb76-53"><a href="#cb76-53" tabindex="-1"></a>  <span class="st">&quot;        });&quot;</span>,</span>
<span id="cb76-54"><a href="#cb76-54" tabindex="-1"></a></span>
<span id="cb76-55"><a href="#cb76-55" tabindex="-1"></a>  <span class="st">&quot;      column.data().unique().sort().each(function(d) {&quot;</span>,</span>
<span id="cb76-56"><a href="#cb76-56" tabindex="-1"></a>  <span class="st">&quot;        select.append(&#39;&lt;option value=</span><span class="sc">\&quot;</span><span class="st">&#39; + d + &#39;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39; + d + &#39;&lt;/option&gt;&#39;);&quot;</span>,</span>
<span id="cb76-57"><a href="#cb76-57" tabindex="-1"></a>  <span class="st">&quot;      });&quot;</span>,</span>
<span id="cb76-58"><a href="#cb76-58" tabindex="-1"></a>  <span class="st">&quot;    } else if (index === 0) {&quot;</span>,</span>
<span id="cb76-59"><a href="#cb76-59" tabindex="-1"></a>  <span class="st">&quot;      // Add text input for symbol search&quot;</span>,</span>
<span id="cb76-60"><a href="#cb76-60" tabindex="-1"></a>  <span class="st">&quot;      $(&#39;&lt;input type=</span><span class="sc">\&quot;</span><span class="st">text</span><span class="sc">\&quot;</span><span class="st"> placeholder=</span><span class="sc">\&quot;</span><span class="st">Search symbol</span><span class="sc">\&quot;</span><span class="st"> style=</span><span class="sc">\&quot;</span><span class="st">width: 100%;</span><span class="sc">\&quot;</span><span class="st">&gt;&#39;)&quot;</span>,</span>
<span id="cb76-61"><a href="#cb76-61" tabindex="-1"></a>  <span class="st">&quot;        .appendTo(cell)&quot;</span>,</span>
<span id="cb76-62"><a href="#cb76-62" tabindex="-1"></a>  <span class="st">&quot;        .on(&#39;keyup change&#39;, function() {&quot;</span>,</span>
<span id="cb76-63"><a href="#cb76-63" tabindex="-1"></a>  <span class="st">&quot;          var val = $(this).val();&quot;</span>,</span>
<span id="cb76-64"><a href="#cb76-64" tabindex="-1"></a>  <span class="st">&quot;          column.search(val).draw();&quot;</span>,</span>
<span id="cb76-65"><a href="#cb76-65" tabindex="-1"></a>  <span class="st">&quot;        });&quot;</span>,</span>
<span id="cb76-66"><a href="#cb76-66" tabindex="-1"></a>  <span class="st">&quot;    } else {&quot;</span>,</span>
<span id="cb76-67"><a href="#cb76-67" tabindex="-1"></a>  <span class="st">&quot;      $(cell).html(&#39;&#39;);&quot;</span>,</span>
<span id="cb76-68"><a href="#cb76-68" tabindex="-1"></a>  <span class="st">&quot;    }&quot;</span>,</span>
<span id="cb76-69"><a href="#cb76-69" tabindex="-1"></a>  <span class="st">&quot;  });&quot;</span>,</span>
<span id="cb76-70"><a href="#cb76-70" tabindex="-1"></a>  <span class="st">&quot;}&quot;</span></span>
<span id="cb76-71"><a href="#cb76-71" tabindex="-1"></a>)</span>
<span id="cb76-72"><a href="#cb76-72" tabindex="-1"></a>  ),</span>
<span id="cb76-73"><a href="#cb76-73" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-74"><a href="#cb76-74" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-75"><a href="#cb76-75" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">&quot;display nowrap&quot;</span></span>
<span id="cb76-76"><a href="#cb76-76" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error: object &#39;aug_last_day_rank&#39; not found</code></pre>
<hr />
</div>
<div id="reason-for-ranking-dismissal" class="section level1">
<h1>Reason for ranking dismissal</h1>
<hr />
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>  reason_for_those_that_did_not_pass_all_filters,</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">&quot;top&quot;</span>,         <span class="co"># Show filter boxes on top of the columns</span></span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">5</span>,</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">targets =</span> <span class="dv">1</span>, <span class="at">searchable =</span> <span class="cn">TRUE</span>)  <span class="co"># Disable search on the &#39;comment&#39; column</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>    )</span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  )</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error: object &#39;reason_for_those_that_did_not_pass_all_filters&#39; not found</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>range_of_analysis <span class="ot">&lt;-</span><span class="fu">range</span>(stock_data_to_save<span class="sc">$</span>date)</span></code></pre></div>
<pre><code>## Error: object &#39;stock_data_to_save&#39; not found</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;This was executed on:&quot;</span>, <span class="fu">Sys.time</span>(), </span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>            <span class="st">&quot;and the range of analysis is from&quot;</span>, </span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>            range_of_analysis[<span class="dv">1</span>], </span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>            <span class="st">&quot;to&quot;</span>, </span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>            range_of_analysis[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## Error: object &#39;range_of_analysis&#39; not found</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">slackr_msg</span>(</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>  <span class="at">text =</span> <span class="st">&quot;New update at &lt;https://leninrafaelrierasegura.github.io/Alpaca/info.html&gt;&quot;</span>,</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>  <span class="at">channel =</span> <span class="st">&quot;#ranks&quot;</span></span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Error in curl::curl_fetch_memory(url, handle = handle): Timeout was reached [slack.com]: Resolving timed out after 10000 milliseconds</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">cite_packages</span>(<span class="at">output =</span> <span class="st">&quot;paragraph&quot;</span>, <span class="at">out.dir =</span> <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p>We used R version 4.5.0 <span class="citation">(R Core Team
2025)</span> and the following R packages: DT v. 0.33 <span
class="citation">(Xie, Cheng, and Tan 2024)</span>, here v. 1.0.1 <span
class="citation">(Müller 2020)</span>, htmltools v. 0.5.8.1 <span
class="citation">(Cheng et al. 2024)</span>, knitr v. 1.50 <span
class="citation">(Xie 2014, 2015, 2025)</span>, renv v. 1.0.7 <span
class="citation">(Ushey and Wickham 2024)</span>, rmarkdown v. 2.29
<span class="citation">(Xie, Allaire, and Grolemund 2018; Xie, Dervieux,
and Riederer 2020; Allaire et al. 2024)</span>, slackr v. 3.3.1 <span
class="citation">(Rudis et al. 2023)</span>, tidyverse v. 2.0.0 <span
class="citation">(Wickham et al. 2019)</span>, xaringanExtra v. 0.8.0
<span class="citation">(Aden-Buie and Warkentin 2024)</span>, zoo v.
1.8.14 <span class="citation">(Zeileis and Grothendieck
2005)</span>.</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-xaringanExtra" class="csl-entry">
Aden-Buie, Garrick, and Matthew T. Warkentin. 2024. <em><span
class="nocase">xaringanExtra</span>: Extras and Extensions for
<span>“<span class="nocase">xaringan</span>”</span> Slides</em>. <a
href="https://doi.org/10.32614/CRAN.package.xaringanExtra">https://doi.org/10.32614/CRAN.package.xaringanExtra</a>.
</div>
<div id="ref-rmarkdown2024" class="csl-entry">
Allaire, JJ, Yihui Xie, Christophe Dervieux, Jonathan McPherson, Javier
Luraschi, Kevin Ushey, Aron Atkins, et al. 2024. <em><span
class="nocase">rmarkdown</span>: Dynamic Documents for r</em>. <a
href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>.
</div>
<div id="ref-htmltools" class="csl-entry">
Cheng, Joe, Carson Sievert, Barret Schloerke, Winston Chang, Yihui Xie,
and Jeff Allen. 2024. <em><span class="nocase">htmltools</span>: Tools
for HTML</em>. <a
href="https://github.com/rstudio/htmltools">https://github.com/rstudio/htmltools</a>.
</div>
<div id="ref-here" class="csl-entry">
Müller, Kirill. 2020. <em><span class="nocase">here</span>: A Simpler
Way to Find Your Files</em>. <a
href="https://doi.org/10.32614/CRAN.package.here">https://doi.org/10.32614/CRAN.package.here</a>.
</div>
<div id="ref-base" class="csl-entry">
R Core Team. 2025. <em><span>R</span>: A Language and Environment for
Statistical Computing</em>. Vienna, Austria: R Foundation for
Statistical Computing. <a
href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-slackr" class="csl-entry">
Rudis, Bob, Jay Jacobs, David Severski, Quinn Weber, Konrad Karczewski,
Shinya Uryu, Gregory Jefferis, et al. 2023. <em><span
class="nocase">slackr</span>: Send Messages, Images, r Objects and Files
to <span>“<span>Slack</span>”</span> Channels/Users</em>. <a
href="https://doi.org/10.32614/CRAN.package.slackr">https://doi.org/10.32614/CRAN.package.slackr</a>.
</div>
<div id="ref-renv" class="csl-entry">
Ushey, Kevin, and Hadley Wickham. 2024. <em><span
class="nocase">renv</span>: Project Environments</em>. <a
href="https://doi.org/10.32614/CRAN.package.renv">https://doi.org/10.32614/CRAN.package.renv</a>.
</div>
<div id="ref-tidyverse" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy
D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019.
<span>“Welcome to the <span class="nocase">tidyverse</span>.”</span>
<em>Journal of Open Source Software</em> 4 (43): 1686. <a
href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-knitr2014" class="csl-entry">
Xie, Yihui. 2014. <span>“<span class="nocase">knitr</span>: A
Comprehensive Tool for Reproducible Research in <span>R</span>.”</span>
In <em>Implementing Reproducible Computational Research</em>, edited by
Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman;
Hall/CRC.
</div>
<div id="ref-knitr2015" class="csl-entry">
———. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd
ed. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-knitr2025" class="csl-entry">
———. 2025. <em><span class="nocase">knitr</span>: A General-Purpose
Package for Dynamic Report Generation in <span>R</span></em>. <a
href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-rmarkdown2018" class="csl-entry">
Xie, Yihui, J. J. Allaire, and Garrett Grolemund. 2018. <em>R Markdown:
The Definitive Guide</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>.
</div>
<div id="ref-DT" class="csl-entry">
Xie, Yihui, Joe Cheng, and Xianying Tan. 2024. <em><span>DT</span>: A
Wrapper of the JavaScript Library
<span>“<span>DataTables</span>”</span></em>. <a
href="https://doi.org/10.32614/CRAN.package.DT">https://doi.org/10.32614/CRAN.package.DT</a>.
</div>
<div id="ref-rmarkdown2020" class="csl-entry">
Xie, Yihui, Christophe Dervieux, and Emily Riederer. 2020. <em>R
Markdown Cookbook</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>.
</div>
<div id="ref-zoo" class="csl-entry">
Zeileis, Achim, and Gabor Grothendieck. 2005. <span>“<span
class="nocase">zoo</span>: S3 Infrastructure for Regular and Irregular
Time Series.”</span> <em>Journal of Statistical Software</em> 14 (6):
1–27. <a
href="https://doi.org/10.18637/jss.v014.i06">https://doi.org/10.18637/jss.v014.i06</a>.
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQWxwYWNhIgpkYXRlOiAiYHIgZm9ybWF0KFN5cy50aW1lKCksICclZC0lbS0lWS4nKWAiCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgbWF0aGpheDogImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vbWF0aGpheEAzL2VzNS90ZXgtbW1sLWNodG1sLmpzIgogICAgaGlnaGxpZ2h0OiBweWdtZW50cwogICAgdGhlbWU6IGZsYXRseQogICAgY29kZV9mb2xkaW5nOiBoaWRlICMgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSIgdG8gaGlkZSBjb2RlIGFuZCBhZGQgYSBidXR0b24gdG8gc2hvdyBpdAogICAgZGZfcHJpbnQ6IHBhZ2VkCiAgICAjIHRvYzogdHJ1ZQogICAgIyB0b2NfZmxvYXQ6CiAgICAjICAgY29sbGFwc2VkOiB0cnVlCiAgICAjICAgc21vb3RoX3Njcm9sbDogdHJ1ZQogICAgbnVtYmVyX3NlY3Rpb25zOiBmYWxzZQogICAgZmlnX2NhcHRpb246IHRydWUKICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKYWx3YXlzX2FsbG93X2h0bWw6IHRydWUKYmlibGlvZ3JhcGh5OiAKICAtIGdyYXRlZnVsLXJlZnMuYmliCmhlYWRlci1pbmNsdWRlczoKICAtIFxuZXdjb21tYW5ke1xhcn17XG1hdGhiYntSfX0KICAtIFxuZXdjb21tYW5ke1xsbGF2fVsxXXtcbGVmdFx7IzFccmlnaHRcfX0KICAtIFxuZXdjb21tYW5ke1xwYXJlfVsxXXtcbGVmdCgjMVxyaWdodCl9CiAgLSBcbmV3Y29tbWFuZHtcTmNhbH17XG1hdGhjYWx7Tn19CiAgLSBcbmV3Y29tbWFuZHtcVmNhbH17XG1hdGhjYWx7Vn19CiAgLSBcbmV3Y29tbWFuZHtcRWNhbH17XG1hdGhjYWx7RX19CiAgLSBcbmV3Y29tbWFuZHtcV2NhbH17XG1hdGhjYWx7V319Ci0tLQoKYGBge3IgeGFyaW5nYW5FeHRyYS1jbGlwYm9hcmQsIGVjaG8gPSBGQUxTRX0KaHRtbHRvb2xzOjp0YWdMaXN0KAogIHhhcmluZ2FuRXh0cmE6OnVzZV9jbGlwYm9hcmQoCiAgICBidXR0b25fdGV4dCA9ICI8aSBjbGFzcz1cImZhLXNvbGlkIGZhLWNsaXBib2FyZFwiIHN0eWxlPVwiY29sb3I6ICMwMDAwOEJcIj48L2k+IiwKICAgIHN1Y2Nlc3NfdGV4dCA9ICI8aSBjbGFzcz1cImZhIGZhLWNoZWNrXCIgc3R5bGU9XCJjb2xvcjogIzkwQkU2RFwiPjwvaT4iLAogICAgZXJyb3JfdGV4dCA9ICI8aSBjbGFzcz1cImZhIGZhLXRpbWVzLWNpcmNsZVwiIHN0eWxlPVwiY29sb3I6ICNGOTQxNDRcIj48L2k+IgogICksCiAgcm1hcmtkb3duOjpodG1sX2RlcGVuZGVuY3lfZm9udF9hd2Vzb21lKCkKKQpgYGAKCgpgYGB7Y3NzLCBlY2hvID0gRkFMU0V9CmJvZHkgLm1haW4tY29udGFpbmVyIHsKICBtYXgtd2lkdGg6IDEwMCUgIWltcG9ydGFudDsKICB3aWR0aDogMTAwJSAhaW1wb3J0YW50Owp9CmJvZHkgewogIG1heC13aWR0aDogMTAwJSAhaW1wb3J0YW50Owp9Cgpib2R5LCB0ZCB7CiAgIGZvbnQtc2l6ZTogMTZweDsKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxNHB4Owp9CnByZSB7CiAgZm9udC1zaXplOiAxNHB4Cn0KLmN1c3RvbS1ib3ggewogIGJhY2tncm91bmQtY29sb3I6ICNmNWY3ZmE7IC8qIExpZ2h0IGdyZXktYmx1ZSBiYWNrZ3JvdW5kICovCiAgYm9yZGVyLWNvbG9yOiAjZTFlOGVkOyAvKiBMaWdodCBib3JkZXIgY29sb3IgKi8KICBjb2xvcjogIzJjM2U1MDsgLyogRGFyayB0ZXh0IGNvbG9yICovCiAgcGFkZGluZzogMTVweDsgLyogUGFkZGluZyBpbnNpZGUgdGhlIGJveCAqLwogIGJvcmRlci1yYWRpdXM6IDVweDsgLyogUm91bmRlZCBjb3JuZXJzICovCiAgbWFyZ2luLWJvdHRvbTogMjBweDsgLyogU3BhY2luZyBiZWxvdyB0aGUgYm94ICovCn0KLmNhcHRpb24gewogIG1hcmdpbjogYXV0bzsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgbWFyZ2luLWJvdHRvbTogMjBweDsgLyogU3BhY2luZyBiZWxvdyB0aGUgYm94ICovCn0KYGBgCgo8ZGl2IHN0eWxlPSJjb2xvcjogYmx1ZTsiPgoqKioqKioqKgoqKlByZXNzIHRoZSBTaG93IGJ1dHRvbiBiZWxvdyB0byByZXZlYWwgdGhlIGNvZGUuKioKCioqKioqKioqCjwvZGl2PgoKCgpgYGB7ciwgZWNobz0gVFJVRX0KIyBTZXQgZ2xvYmFsIG9wdGlvbnMgZm9yIGFsbCBjb2RlIGNodW5rcwprbml0cjo6b3B0c19jaHVuayRzZXQoCiAgIyBEaXNhYmxlIG1lc3NhZ2VzIHByaW50ZWQgYnkgUiBjb2RlIGNodW5rcwogIG1lc3NhZ2UgPSBGQUxTRSwgICAgCiAgIyBEaXNhYmxlIHdhcm5pbmdzIHByaW50ZWQgYnkgUiBjb2RlIGNodW5rcwogIHdhcm5pbmcgPSBGQUxTRSwgICAgCiAgIyBTaG93IFIgY29kZSB3aXRoaW4gY29kZSBjaHVua3MgaW4gb3V0cHV0CiAgZWNobyA9IFRSVUUsICAgICAgICAKICAjIEluY2x1ZGUgYm90aCBSIGNvZGUgYW5kIGl0cyByZXN1bHRzIGluIG91dHB1dAogIGluY2x1ZGUgPSBUUlVFLCAgICAgCiAgIyBFdmFsdWF0ZSBSIGNvZGUgY2h1bmtzCiAgZXZhbCA9IFRSVUUsICAgICAgIAogICMgRW5hYmxlIGNhY2hpbmcgb2YgUiBjb2RlIGNodW5rcyBmb3IgZmFzdGVyIHJlbmRlcmluZwogIGNhY2hlID0gRkFMU0UsICAgICAgCiAgIyBBbGlnbiBmaWd1cmVzIGluIHRoZSBjZW50ZXIgb2YgdGhlIG91dHB1dAogIGZpZy5hbGlnbiA9ICJjZW50ZXIiLAogICMgRW5hYmxlIHJldGluYSBkaXNwbGF5IGZvciBoaWdoLXJlc29sdXRpb24gZmlndXJlcwogIHJldGluYSA9IDIsCiAgIyBTaG93IGVycm9ycyBpbiB0aGUgb3V0cHV0IGluc3RlYWQgb2Ygc3RvcHBpbmcgcmVuZGVyaW5nCiAgZXJyb3IgPSBUUlVFLAogICMgRG8gbm90IGNvbGxhcHNlIGNvZGUgYW5kIG91dHB1dCBpbnRvIGEgc2luZ2xlIGJsb2NrCiAgY29sbGFwc2UgPSBGQUxTRQopCiMgU3RhcnQgdGhlIGZpZ3VyZSBjb3VudGVyCmZpZ19jb3VudCA8LSAwCiMgRGVmaW5lIHRoZSBjYXB0aW9uZXIgZnVuY3Rpb24KY2FwdGlvbmVyIDwtIGZ1bmN0aW9uKGNhcHRpb24pIHsKICBmaWdfY291bnQgPDwtIGZpZ19jb3VudCArIDEKICBwYXN0ZTAoIkZpZ3VyZSAiLCBmaWdfY291bnQsICI6ICIsIGNhcHRpb24pCn0KIyBEZWZpbmUgdGhlIGZ1bmN0aW9uIHRvIHRydW5jYXRlIGEgbnVtYmVyIHRvIHR3byBkZWNpbWFsIHBsYWNlcwp0cnVuY2F0ZV90b190d28gPC0gZnVuY3Rpb24oeCkgewogIGZsb29yKHggKiAxMDApIC8gMTAwCn0KYGBgCgpgYGB7cn0KIyBMb2FkIHJlcXVpcmVkIGxpYnJhcmllcwpsaWJyYXJ5KGh0dHIpCmxpYnJhcnkoanNvbmxpdGUpCmxpYnJhcnkocmVhZHIpCmxpYnJhcnkoZHBseXIpCmxpYnJhcnkoem9vKSAjIHRvIHVzZSBuYS5sb2NmCmxpYnJhcnkodGlkeXIpICMgdG8gdXNlIHBpdm90X3dpZGVyCmxpYnJhcnkoc2xhY2tyKQpsaWJyYXJ5KGdyYXRlZnVsKQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkoRFQpIAoKaW5pdGlhbF9kYXRlIDwtIGFzLkRhdGUoIjIwMjUtMDQtMjMiKQpzb3VyY2UoaGVyZSgia2V5cy5SIikpCnNsYWNrcl9zZXR1cCh0b2tlbiA9IHRva2VuKQoKZm9ybWF0X21hcmtldF9jYXAgPC0gZnVuY3Rpb24oeCkgewogIHNhcHBseSh4LCBmdW5jdGlvbih2YWwpIHsKICAgIGlmIChpcy5uYSh2YWwpKSB7CiAgICAgIHJldHVybigiTkEiKQogICAgfQogICAgCiAgICB2YWwgPC0gYXMubnVtZXJpYyh2YWwpCiAgICAKICAgIGlmICh2YWwgPj0gMWUxMikgewogICAgICByZXR1cm4oc3ByaW50ZigiJS4xZlQiLCB2YWwgLyAxZTEyKSkKICAgIH0gZWxzZSBpZiAodmFsID49IDFlOSkgewogICAgICByZXR1cm4oc3ByaW50ZigiJS4xZkIiLCB2YWwgLyAxZTkpKQogICAgfSBlbHNlIGlmICh2YWwgPj0gMWU2KSB7CiAgICAgIHJldHVybihzcHJpbnRmKCIlLjFmTSIsIHZhbCAvIDFlNikpCiAgICB9IGVsc2UgaWYgKHZhbCA+PSAxZTMpIHsKICAgICAgcmV0dXJuKHNwcmludGYoIiUuMWZrIiwgdmFsIC8gMWUzKSkKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybihhcy5jaGFyYWN0ZXIodmFsKSkKICAgIH0KICB9KQp9CmBgYAoKCiMgRGF0YSBkZXNjcmlwdGlvbgoKCkRhdGEgaXMgZG93bmxvYWRlZCBkYWlseSBmcm9tIFtoZXJlXShodHRwczovL3d3dy5uYXNkYXEuY29tL21hcmtldC1hY3Rpdml0eS9zdG9ja3Mvc2NyZWVuZXIpLiBUaGUgYGxhc3RzYWxlYCB2YWx1ZSByZXBvcnRlZCBpbiB0aGUgcHJldmlvdXMgbGluayBpcyB0aGUgb3BlbiBwcmljZSB3aGVuIHRoZSBtYXJrZXQgY2xvc2VzLCBhY2NvcmRpbmcgdG8gdGhpcyBbd2Vic2l0ZV0oaHR0cHM6Ly9maW5hbmNlLnlhaG9vLmNvbS8pLgoKRGF0YSBjb2xsZWN0aW9uIHN0YXJ0ZWQgb24gQXByaWwgMjMsIDIwMjUuCgoKYGBge3J9CmF1eF9kYXkgPC0gU3lzLkRhdGUoKQpkYXlfb2Zfd2VlayA8LSB3ZWVrZGF5cyhhdXhfZGF5KQoKaWYgKGRheV9vZl93ZWVrID09ICJNb25kYXkiKSB7CiAgdG9kYXkgPC0gYXV4X2RheSAtIDMKfSBlbHNlIGlmIChkYXlfb2Zfd2VlayAlaW4lIGMoIlR1ZXNkYXkiLCAiV2VkbmVzZGF5IiwgIlRodXJzZGF5IiwgIkZyaWRheSIpKSB7CiAgdG9kYXkgPC0gYXV4X2RheSAtIDEKfSBlbHNlIHsKICB0b2RheSA8LSBhdXhfZGF5ICAjIG9yIGhhbmRsZSBTYXR1cmRheS9TdW5kYXkgaG93ZXZlciB5b3Ugd2FudAp9CiMgRGVmaW5lIHRoZSBBUEkgVVJMCnVybCA8LSAiaHR0cHM6Ly9hcGkubmFzZGFxLmNvbS9hcGkvc2NyZWVuZXIvc3RvY2tzP3RhYmxlb25seT10cnVlJmxpbWl0PTI1Jm9mZnNldD0wJmRvd25sb2FkPXRydWUiCiMgU2V0IGhlYWRlcnMgdG8gbWltaWMgYSBicm93c2VyCmhlYWRlcnMgPC0gYWRkX2hlYWRlcnMoYFVzZXItQWdlbnRgID0gIk1vemlsbGEvNS4wIikKIyBTZW5kIEdFVCByZXF1ZXN0CnJlc3BvbnNlIDwtIEdFVCh1cmwsIGhlYWRlcnMpCiMgQ2hlY2sgc3RhdHVzCmlmIChzdGF0dXNfY29kZShyZXNwb25zZSkgPT0gMjAwKSB7CiAgIyBQYXJzZSBKU09OIGNvbnRlbnQKICBjb250ZW50X2pzb24gPC0gY29udGVudChyZXNwb25zZSwgInRleHQiLCBlbmNvZGluZyA9ICJVVEYtOCIpCiAgZGF0YV9saXN0IDwtIGZyb21KU09OKGNvbnRlbnRfanNvbiwgZmxhdHRlbiA9IFRSVUUpCgogICMgRXh0cmFjdCByb3dzIGZyb20gSlNPTgogIHN0b2NrX2RhdGEgPC0gZGF0YV9saXN0JGRhdGEkcm93cwogICMgQWRkIGN1cnJlbnQgZGF0ZSBjb2x1bW4KICBzdG9ja19kYXRhJGRhdGUgPC0gdG9kYXkKCiAgIyBDcmVhdGUgZmlsZW5hbWUgd2l0aCB0b2RheSdzIGRhdGUKICBmaWxlX25hbWUgPC0gcGFzdGUwKCJuYXNkYXFfc2NyZWVuZXJfIiwgdG9kYXksICIuY3N2IikKCiAgIyBTYXZlIHRvIENTVgogIHdyaXRlX2NzdihzdG9ja19kYXRhLCBoZXJlKCJkYXRhIiwgZmlsZV9uYW1lKSkKICBjYXQoIuKchSBEYXRhIHNhdmVkIHRvIiwgZmlsZV9uYW1lLCAiXG4iKQp9IGVsc2UgewogIGNhdCgi4p2MIEZhaWxlZCB0byBmZXRjaCBkYXRhLiBTdGF0dXMgY29kZToiLCBzdGF0dXNfY29kZShyZXNwb25zZSksICJcbiIpCn0KCiMgVGhlIGZvbGxvd2luZyBsaW5lIHNob3VsZCByZXBsYWNlIHRoZSBuZXh0IGZvbGxvd2luZyBsaW5lCnRvZGF5X3N0b2NrX2RhdGEgPC0gcmVhZF9jc3YoaGVyZSgiZGF0YSIsIGZpbGVfbmFtZSkpICB8PgogIGZpbHRlcihuY2hhcihzeW1ib2wpPDUpIHw+ICMgZmlsdGVyIG91dCBzdG9ja3Mgd2l0aCBtb3JlIHRoYW4gNCBjaGFyYWN0ZXJzIChub3QgdHJhZGVhYmxlKQogIGZpbHRlcighZ3JlcGwoIlxcXiIsIHN5bWJvbCkpIHw+ICMgcmVtb3ZlIHN5bWJvbHMgY29udGFpbmluZyBeCiAgc2VsZWN0KC11cmwsIC1uZXRjaGFuZ2UsIC1wY3RjaGFuZ2UpIHw+ICMgcmVtb3ZlIHVubmVjZXNzYXJ5IGNvbHVtbnMKICBtdXRhdGUobGFzdHNhbGUgPSBhcy5udW1lcmljKGdzdWIoIlskLF0iLCAiIiwgbGFzdHNhbGUpKSkgfD4jIHJlbW92ZSAkIGFuZCAsIGZyb20gbGFzdHNhbGUgYW5kIG1ha2UgaXQgbnVtZXJpYwogIHNlbGVjdChzeW1ib2wsIGRhdGUsIGxhc3RzYWxlLCBldmVyeXRoaW5nKCkpICMgcmVvcmRlciBjb2x1bW5zCgojIFJlbW92ZSBzeW1ib2xzIHRoYXQgYXJlIG5vdCBsb25nZXIgYmVpbmcgdHJhZGVkCmN1bW11bGF0aXZlX3N0b2NrX2RhdGEgPC0gcmVhZFJEUyhoZXJlKCJkYXRhL2N1bW11bGF0aXZlX3N0b2NrX2RhdGEuUkRTIikpIHw+CiAgZmlsdGVyKHN5bWJvbCAlaW4lIHRvZGF5X3N0b2NrX2RhdGEkc3ltYm9sKQoKIyBUaGUgZm9sbG93aW5nIHR3byBpbnN0cnVjdGlvbnMgZGVhbHMgd2l0aCBuZXdfZGF0YSBiZWluZyBhZGRlZCB3aGVuIGl0IGlzIGFscmVhZHkgdGhlcmUuCiMgVGhpcyBtaWdodCBoYXBwZW4gd2hlbiB0aGUgc3RvY2sgbWFya2V0IGlzIGNsb3NlZCBkdXJpbmcgd2Vla2RheXMKCiMgS2VlcCBvbmx5IHJvd3MgZnJvbSB0b2RheV9zdG9ja19kYXRhIHRoYXQgYXJlIE5PVCBhbHJlYWR5IGluIGN1bW11bGF0aXZlX3N0b2NrX2RhdGEKbmV3X3RvZGF5X3N0b2NrX2RhdGEgPC0gYW50aV9qb2luKHRvZGF5X3N0b2NrX2RhdGEsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VtbXVsYXRpdmVfc3RvY2tfZGF0YSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieSA9IHNldGRpZmYobmFtZXModG9kYXlfc3RvY2tfZGF0YSksICJkYXRlIikpICMgSWRlbnRpZnkgY29sdW1ucyB0byBtYXRjaCAoZXZlcnl0aGluZyBleGNlcHQgJ2RhdGUnKQoKY2xlYW5fY3VtbXVsYXRpdmVfc3RvY2tfZGF0YSA8LSBiaW5kX3Jvd3MoY3VtbXVsYXRpdmVfc3RvY2tfZGF0YSwgbmV3X3RvZGF5X3N0b2NrX2RhdGEpIHw+CiAgYXJyYW5nZShzeW1ib2wsIGRhdGUpIHw+CiAgc2VsZWN0KHN5bWJvbCwgZGF0ZSwgbGFzdHNhbGUsIG1hcmtldENhcCwgY291bnRyeSwgaW5kdXN0cnksIHNlY3RvciwgaXBveWVhciwgdm9sdW1lLCBuYW1lKQoKIyBHZXQgdW5pcXVlIGRhdGVzIGZyb20gdGhlIGRhdGFzZXQKdW5pcXVlX2RhdGVzIDwtIHNvcnQodW5pcXVlKGNsZWFuX2N1bW11bGF0aXZlX3N0b2NrX2RhdGEkZGF0ZSkpCgojIFN0ZXAgMTogRXhwYW5kIGVhY2ggc3ltYm9sIHRvIGFsbCBleGlzdGluZyBkYXRlcwpzdG9ja19kYXRhX2V4cGFuZGVkIDwtIGNsZWFuX2N1bW11bGF0aXZlX3N0b2NrX2RhdGEgfD4KICBncm91cF9ieShzeW1ib2wpIHw+CiAgY29tcGxldGUoZGF0ZSA9IHVuaXF1ZV9kYXRlcykgfD4KICB1bmdyb3VwKCkKCiMgU3RlcCAyOiBGaWxsIGJhY2t3YXJkIGZvciBtdWx0aXBsZSBjb2x1bW5zCmNvbHVtbnNfdG9fZmlsbCA8LSBjKAogICJsYXN0c2FsZSIsICJtYXJrZXRDYXAiLCAiY291bnRyeSIsICJpbmR1c3RyeSIsIAogICJzZWN0b3IiLCAiaXBveWVhciIsICJ2b2x1bWUiLCAibmFtZSIKKQoKc3RvY2tfZGF0YV9maWxsZWQgPC0gc3RvY2tfZGF0YV9leHBhbmRlZCB8PgogIGdyb3VwX2J5KHN5bWJvbCkgfD4KICBhcnJhbmdlKGRhdGUsIC5ieV9ncm91cCA9IFRSVUUpIHw+CiAgbXV0YXRlKGFjcm9zcyhhbGxfb2YoY29sdW1uc190b19maWxsKSwKICAgICAgICAgICAgICAgIH4gem9vOjpuYS5sb2NmKC54LCBmcm9tTGFzdCA9IFRSVUUsIG5hLnJtID0gRkFMU0UpKSkgfD4gIyBmaWxsaW5nIGZyb20gdGhlIGxhc3QgYXZhaWxhYmxlIHZhbHVlIGJhY2t3YXJkCiAgbXV0YXRlKGFjcm9zcyhhbGxfb2YoY29sdW1uc190b19maWxsKSwKICAgICAgICAgICAgICAgIH4gem9vOjpuYS5sb2NmKC54LCBmcm9tTGFzdCA9IEZBTFNFLCBuYS5ybSA9IEZBTFNFKSkpIHw+ICMgZmlsbGluZyBmcm9tIHRoZSBmaXJzdCBhdmFpbGFibGUgdmFsdWUgZm9yd2FyZAogIHVuZ3JvdXAoKSB8PgogIGFycmFuZ2Uoc3ltYm9sLCBkYXRlKQoKc3RvY2tfZGF0YV90b19zYXZlIDwtIHN0b2NrX2RhdGFfZmlsbGVkIHw+CiAgZ3JvdXBfYnkoc3ltYm9sKSB8PgogIGFycmFuZ2UoZGF0ZSwgLmJ5X2dyb3VwID0gVFJVRSkgfD4KICBmaWx0ZXIoIWFueShpcy5uYShsYXN0c2FsZSkpKSB8PgogIHVuZ3JvdXAoKSB8PgogIGFycmFuZ2Uoc3ltYm9sLCBkYXRlKQoKc2F2ZVJEUyhzdG9ja19kYXRhX3RvX3NhdmUsIGhlcmUoImRhdGEvY3VtbXVsYXRpdmVfc3RvY2tfZGF0YS5SRFMiKSkKYGBgCgojIEZpbHRlcnMKCkxldCBgWF9rKHRfaSlgIGRlbm90ZSB0aGUgdmFsdWUgb2YgYSBzdG9jayBgWF9rYCBhdCBkYXkgYHRfaWAsIHdoZXJlIGBpPSAwLC4uLixOYC4gTGV0IGBwY3QgWF9rKHRfaSlgIGRlbm90ZSB0aGUgcGVyY2VudGFnZSBjaGFuZ2Ugb2YgYFhfayh0X2kpYCB3aXRoIHJlc3BlY3QgdG8gYFhfayh0XzApYCwgaS5lLiwgYHBjdCBYX2sodF9pKSA9IChYX2sodF9pKSAtIFhfayh0XzApKS9YX2sodF8wKSAqIDEwMCBgLiBGb3IgZWFjaCBzdG9jayBgWF9rYCwgdGhlIGZpbHRlcnMgYXJlIGFzIGZvbGxvd3M6CgotIFRoZSBmaXJzdCBmaWx0ZXIgaXMgdGhhdCBgWF9rKHRfMCkgPD0gWF9rKHRfTilgLCBpLmUuLCB0aGUgc3RvY2sgbXVzdCBoYXZlIGEgcG9zaXRpdmUgZ3Jvd3RoIHRyZW5kIHdpdGhpbiB0aGUgcGVyaW9kIG9mIGFuYWx5c2lzLgoKLSBUaGUgc2Vjb25kIGZpbHRlciBpcyB0aGF0IGAwLjgqWF9rKHRfe2ktMX0pIDw9IFhfayh0X2kpIDw9IDIqWF9rKHRfe2ktMX0pYCwgaS5lLiwgdGhlIG5leHQgZGF5IHByaWNlIGlzIGF0IG1vc3QgdHdpY2UgYW5kIGF0IGxlYXN0IDgwJSBvZiB0aGUgbGFzdCBwcmljZSAoZnJvbSBkYXkgdG8gZGF5IGl0IGNhbiBvbmx5IGZhbGwgMjAlKS4KCi0gVGhlIHRoaXJkIGZpbHRlciBpcyB0aGF0IGBtYXh7IHBjdCBYX2sodF8wKSwgLi4uLCBwY3QgWF9rKHRfe04tMX0pfSAvIDIgPD0gcGN0IFhfayh0X04pYCwgaS5lLiwgdGhlIGZpbmFsIHByaWNlIGdyb3d0aCBpcyBhdCBsZWFzdCBoYWxmIG9mIHRoZSBoaWdoZXN0IGdyb3d0aC4KCi0gVGhlIGZvdXJ0aCBmaWx0ZXIgaXMgdGhhdCBgbWlue3xwY3QgWF9rKHRfMCl8LCAuLi4sIHxwY3QgWF9rKHRfe04tMX0pfH0gPD0gcGN0IFhfayh0X04pYCwgaS5lLiwgdGhlIHN0b2NrIG11c3Qgbm90IGhhdmUgZmFsbGVuIG1vcmUgdGhhbiB3aGF0IGl0IGhhcyBncm93bi4KCmBgYHtyfQojIHN0b2NrX2RhdGFfdG9fc2F2ZSA8LSByZWFkUkRTKGhlcmUoImRhdGEvY3VtbXVsYXRpdmVfc3RvY2tfZGF0YS5SRFMiKSkKCnN0b2Nrc19kYXRhX3dpdGhfY29tbWVudF9jb2x1bW4gPC0gc3RvY2tfZGF0YV90b19zYXZlIHw+IAogIG11dGF0ZShjb21tZW50ID0gTkFfY2hhcmFjdGVyXykKCiMgVGhlIGZvbGxvd2luZyBlbnN1cmVzIHRoYXQgd2Ugb25seSBrZWVwIHN0b2NrcyB0aGF0IGhhdmUgYSBwb3NpdGl2ZSBncm93dGggdHJlbmQKc3RvY2tzX2RhdGFfZ3JvdyA8LSBzdG9ja3NfZGF0YV93aXRoX2NvbW1lbnRfY29sdW1uIHw+IAogIGdyb3VwX2J5KHN5bWJvbCkgfD4KICBhcnJhbmdlKGRhdGUsIC5ieV9ncm91cCA9IFRSVUUpIHw+CiAgbXV0YXRlKGNvbW1lbnQgPSBpZl9lbHNlKAogICAgaXMubmEoY29tbWVudCkgJiAhKGZpcnN0KGxhc3RzYWxlKSA8PSBsYXN0KGxhc3RzYWxlKSksIAogICAgImRpZCBub3QgcGFzcyBYKHRfMCkgPD0gWCh0X04pIiwgCiAgICBjb21tZW50CiAgKSkgfD4KICB1bmdyb3VwKCkKCiMgVGhlIGZvbGxvd2luZyBlbnN1cmVzIHRoYXQgdGhlIG5leHQgZGF5IHByaWNlIGlzIGF0IG1vc3QgdHdpY2UgYW5kIGF0IGxlYXN0IDgwJSBvZiB0aGUgbGFzdCBwcmljZSAoZnJvbSBkYXkgdG8gZGF5IGl0IGNhbiBvbmx5IGZhbGwgMjAlKQpzdG9ja3NfZGF0YV93aW5kb3cgPC0gc3RvY2tzX2RhdGFfZ3JvdyB8PgogIGdyb3VwX2J5KHN5bWJvbCkgfD4KICBhcnJhbmdlKGRhdGUsIC5ieV9ncm91cCA9IFRSVUUpIHw+CiAgbXV0YXRlKAogICAgY29tbWVudCA9IGlmX2Vsc2UoCiAgICAgIGlzLm5hKGNvbW1lbnQpICYgIWFsbCgobGVhZChsYXN0c2FsZSkgPiAwLjggKiBsYXN0c2FsZSkgJiAobGVhZChsYXN0c2FsZSkgPCAyICogbGFzdHNhbGUpLCBuYS5ybSA9IFRSVUUpLAogICAgICAiZGlkIG5vdCBwYXNzIDAuOCpYKHRfe2ktMX0pIDw9IFgodF9pKSA8PSAyKlgodF97aS0xfSkiLCAKICAgICAgY29tbWVudAogICAgKSkgfD4KICB1bmdyb3VwKCkKCgojIENvbXB1dGUgdGhlIHBlcmNlbnRhZ2UgY2hhbmdlIGZyb20gdGhlIHN0YXJ0IGRhdGUgKGRhaWx5IGFuZCBhY2N1bXVsYXRlZCkKIyBLZWVwIG9ubHkgdGhvc2Ugc3RvY2tzIHdoZXJlIHRoZSBmaW5hbCBwcmljZSBncm93dGggaXMgYXQgbGVhc3QgaGFsZiBvZiB0aGUgaGlnaGVzdCBncm93dGggKGJlZm9yZSB0aGUgZW5kKS4Kc3RvY2tfZGF0YV9wY3RfY2hhbmdlIDwtIHN0b2Nrc19kYXRhX3dpbmRvdyB8PgogIGdyb3VwX2J5KHN5bWJvbCkgfD4KICBhcnJhbmdlKGRhdGUsIC5ieV9ncm91cCA9IFRSVUUpIHw+CiAgbXV0YXRlKGRhaWx5X3BjdF9jaGFuZ2UgPSAobGFzdHNhbGUgLSBsYWcobGFzdHNhbGUpKSAvIGxhZyhsYXN0c2FsZSkgKiAxMDAsCiAgICAgICAgIGFjY3VtX3BjdF9jaGFuZ2UgPSAobGFzdHNhbGUgLSBmaXJzdChsYXN0c2FsZSkpIC8gZmlyc3QobGFzdHNhbGUpICogMTAwKSB8PgogIG11dGF0ZShjb21tZW50ID0gaWZfZWxzZSgKICAgIGlzLm5hKGNvbW1lbnQpICYgISgobWF4KGhlYWQoYWNjdW1fcGN0X2NoYW5nZSwgLTEpKSAvIDIpIDw9IGxhc3QoYWNjdW1fcGN0X2NoYW5nZSkpLAogICAgImRpZCBub3QgcGFzcyBtYXh7cGN0IFgodF8wKSwgLi4uLCBwY3QgWCh0X3tOLTF9KX0gLyAyIDw9IHBjdCBYKHRfTikiLCAKICAgIGNvbW1lbnQKICApKSB8PgogIHVuZ3JvdXAoKSAKCiMgRmlsdGVyIHN5bWJvbHMgdGhhdCBoYXZlIGZhbGxlbiAoYW55dGltZSkgbW9yZSB0aGF0IHdoYXQgdGhleSBoYXZlIGdyb3duIChhdCB0aGUgZW5kKQpzdG9ja19kYXRhX3BjdF9jaGFuZ2VfdGhhdF9ncm93IDwtIHN0b2NrX2RhdGFfcGN0X2NoYW5nZSB8PgogIGdyb3VwX2J5KHN5bWJvbCkgfD4KICBhcnJhbmdlKGRhdGUsIC5ieV9ncm91cCA9IFRSVUUpIHw+CiAgbXV0YXRlKAogICAgY29tbWVudCA9IGlmX2Vsc2UoCiAgICAgIGlzLm5hKGNvbW1lbnQpICYKICAgICAgYW55KGFjY3VtX3BjdF9jaGFuZ2UgPCAwKSAmICEoYWJzKG1pbihoZWFkKGFjY3VtX3BjdF9jaGFuZ2UsIC0xKSkpIDw9IGxhc3QoYWNjdW1fcGN0X2NoYW5nZSkpLAogICAgICAiZGlkIG5vdCBwYXNzIG1pbnt8cGN0IFgodF8wKXwsIC4uLiwgfHBjdCBYKHRfe04tMX0pfH0gPD0gcGN0IFgodF9OKSIsCiAgICAgIGNvbW1lbnQKICAgICkKICApIHw+CiAgdW5ncm91cCgpCgojIFJlbW92ZXMgdGhlIGZpcnN0IGRhdGUgKHRoZSBvbmUgdGhhdCB3YXMgdXNlZCB0byBjb21wdXRlIHRoZSBkYWlseSBwZXJjZW50YWdlIGNoYW5nZSkKYXV4IDwtIHN0b2NrX2RhdGFfcGN0X2NoYW5nZV90aGF0X2dyb3cgfD4KICBmaWx0ZXIoZGF0ZSAhPSBtaW4oZGF0ZSkpCgpBVVhfdG9fcmFuayA8LSBhdXggfD4KICBmaWx0ZXIoaXMubmEoY29tbWVudCkpCgojIEZyb20gaGVyZSBvbiB0aGVyZSBhcmUgbm8gbW9yZSBmaWx0ZXJzCmBgYAoKCiMgUmFua2luZ3MKCkxldCBgUl9qYCBiZSB0aGUgcmFuayBvZiB0aGUgc3RvY2tzIGFjY29yZGluZyB0byB0aGVpciBwZXJjZW50YWdlIGNoYW5nZSBgcGN0IFhfayh0X2kpYCBhdCBkYXkgYHRfaWAuIFRoZSByYW5rcyBpcyBjb21wdXRlZCBhcyBmb2xsb3dzOgoKLSBgQWNjdW11bGF0ZWQgcmFua2AuIE1vcmUgY29tcGxpY2F0ZWQgdGhhbiB0aGUgb3RoZXJzLiBUaGUgaWRlYSBpcyB0byBjb21wdXRlIHRoZSByYW5rIG9mIGVhY2ggc3RvY2sgYXQgZWFjaCBkYXRlLCBhbmQgdGhlbiBhY2N1bXVsYXRlIHRoZSByYW5rcyBhY2NvcmRpbmcgdG8gdGhlIGZvbGxvd2luZyBsb2dpYzoKCiAgLSBJZiBgUl9qKHRfaSkgPj0gUl9qKHRfe2ktMX0pYCwgdGhlbiBgUl9qKHRfaSkgPSBSX2oodF97aS0xfSkgKyBSX2oodF9pKWAuCiAgLSBJZiBgUl9qKHRfaSkgPCBSX2oodF97aS0xfSlgLCB0aGVuIGBSX2oodF9pKSA9IFJfaih0X3tpLTF9KSAtIFJfaih0X2kpYC4KCiAgVGhpcyBtZWFucyB0aGF0IGlmIGEgc3RvY2sgaGFzIGEgYmV0dGVyIHJhbmsgdGhhbiB0aGUgcHJldmlvdXMgZGF5LCBpdHMgYWNjdW11bGF0ZWQgcmFuayBpbmNyZWFzZXMgYnkgdGhlIHZhbHVlIG9mIGl0cyBjdXJyZW50IHJhbmsuIElmIGl0IGhhcyBhIHdvcnNlIHJhbmssIGl0cyBhY2N1bXVsYXRlZCByYW5rIGRlY3JlYXNlcyBieSB0aGUgdmFsdWUgb2YgaXRzIGN1cnJlbnQgcmFuay4KCi0gYFN1bSBvZiByYW5rc2AuIFRoaXMgaXMgc2ltcGx5IGBSXzEgKyBSXzIgKyAuLi4gKyBSX05gLgoKLSBgTGFzdCBkYXkgcmFua2AuIFRoaXMgaXMgc2ltcGx5IGBSX05gLgoKCgpgYGB7cn0KIyBUaGUgZm9sbG93aW5nIGNvbnRhaW5zIHRoZSBpbmZvcm1hdGlvbiBvZiB0aGUgc3Vydml2aW5nIHN5bWJvbHMKaW5mb19vZl9zdXJ2aXZpbmdfc3ltYm9scyA8LSBhdXggfD4KICBmaWx0ZXIoZGF0ZSA9PSBtYXgoZGF0ZSkpIHw+ICMgc28gd2UgZ2V0IHRoZSBsYXN0IG1hcmtldCBjYXAgYW5kIHZvbHVtZSwgZm9yIGV4YW1wbGUKICBzZWxlY3QoLWRhdGUsIC1kYWlseV9wY3RfY2hhbmdlKSB8PgogIG11dGF0ZShtYXJrZXRDYXBfID0gZm9ybWF0X21hcmtldF9jYXAobWFya2V0Q2FwKSwKICAgICAgICAgYWNjdW1fcGN0X2NoYW5nZSA9IHJvdW5kKGFjY3VtX3BjdF9jaGFuZ2UsIDIpKQoKIyBUaGUgZm9sbG93aW5nIGlzIHRoZSBsaXN0IG9mIHN5bWJvbHMgdGhhdCBwYXNzZWQgYWxsIGZpbHRlcnMKaW5mb19vZl90aG9zZV90aGF0X3Bhc3NlZF9hbGxfZmlsdGVycyA8LSBpbmZvX29mX3N1cnZpdmluZ19zeW1ib2xzIHw+CiAgZmlsdGVyKGlzLm5hKGNvbW1lbnQpKSB8PgogIHNlbGVjdCgtY29tbWVudCkKCiMgVGhlIGZvbGxvd2luZyBpcyB0aGUgbGlzdCBvZiBzeW1ib2xzIHRoYXQgZGlkIG5vdCBwYXNzIGFsbCBmaWx0ZXJzCnJlYXNvbl9mb3JfdGhvc2VfdGhhdF9kaWRfbm90X3Bhc3NfYWxsX2ZpbHRlcnMgPC0gaW5mb19vZl9zdXJ2aXZpbmdfc3ltYm9scyB8PgogIGZpbHRlcighaXMubmEoY29tbWVudCkpIHw+CiAgc2VsZWN0KHN5bWJvbCwgY29tbWVudCkKIAojIENvbXB1dGUgdGhlIHJhbmsgZm9yIGVhY2ggZGF0ZQphdXhfcmFua2VkIDwtIEFVWF90b19yYW5rIHw+IAogIGdyb3VwX2J5KGRhdGUpIHw+CiAgYXJyYW5nZShhY2N1bV9wY3RfY2hhbmdlKSB8PgogIG11dGF0ZShyYW5rID0gcm93X251bWJlcigpKSB8PgogIHVuZ3JvdXAoKSB8PgogIGFycmFuZ2Uoc3ltYm9sLGRhdGUpCgojIENvbXB1dGUgbGFzdCBkYXkgcmFuawpsYXN0X2RheV9yYW5rIDwtIGF1eF9yYW5rZWQgfD4KICBncm91cF9ieShzeW1ib2wpIHw+CiAgZmlsdGVyKGRhdGUgPT0gbWF4KGRhdGUpKSB8PgogIHN1bW1hcmlzZShsYXN0X3JhbmsgPSByYW5rKSB8PgogIHVuZ3JvdXAoKSB8PgogIGFycmFuZ2UoZGVzYyhsYXN0X3JhbmspKQoKIyBDb21wdXRlIHRoZSBzdW0gb2YgcmFua3MgCnN1bV9yYW5rIDwtIGF1eF9yYW5rZWQgfD4KICBncm91cF9ieShzeW1ib2wpIHw+CiAgc3VtbWFyaXNlKHN1bV9yYW5rID0gc3VtKHJhbmspKSB8PgogIHVuZ3JvdXAoKSB8PgogIGFycmFuZ2UoZGVzYyhzdW1fcmFuaykpCgojIENyZWF0ZSB0aGUgdGFibGUgb2YgcmFua3MKdGFibGVfb2ZfcmFua3MgPC0gYXV4X3JhbmtlZCB8PgogIHNlbGVjdChzeW1ib2wsIGRhdGUsIHJhbmspIHw+CiAgcGl2b3Rfd2lkZXIoCiAgICBuYW1lc19mcm9tID0gZGF0ZSwKICAgIHZhbHVlc19mcm9tID0gcmFuawogICkKCiMgYXNzdW1lIGZpcnN0IGNvbHVtbiBpcyAnc3ltYm9sJwpyYW5raW5nX2FjY3VtdWxhdGVkIDwtIHRhYmxlX29mX3JhbmtzCgojIEdldCBvbmx5IHRoZSBudW1lcmljIHBhcnQgKHRoZSByYW5rcykKcmFua19tYXRyaXggPC0gYXMubWF0cml4KHRhYmxlX29mX3JhbmtzWywtMV0pCgojIEFwcGx5IHRoZSBjdXN0b20gYWNjdW11bGF0aW9uIGxvZ2ljIHJvdy13aXNlCmFjY3VtdWxhdGVkX21hdHJpeCA8LSB0KGFwcGx5KHJhbmtfbWF0cml4LCAxLCBmdW5jdGlvbihyb3cpIHsKICBhY2MgPC0gbnVtZXJpYyhsZW5ndGgocm93KSkKICBhY2NbMV0gPC0gcm93WzFdCiAgZm9yIChpIGluIDI6bGVuZ3RoKHJvdykpIHsKICAgIGlmIChyb3dbaV0gPj0gcm93W2kgLSAxXSkgewogICAgICBhY2NbaV0gPC0gYWNjW2kgLSAxXSArIHJvd1tpXQogICAgfSBlbHNlIHsKICAgICAgYWNjW2ldIDwtIGFjY1tpIC0gMV0gLSByb3dbaV0KICAgIH0KICB9CiAgcmV0dXJuKGFjYykKfSkpCgojIENvbWJpbmUgd2l0aCBzeW1ib2xzIGFnYWluCnJhbmtpbmdfYWNjdW11bGF0ZWRbLC0xXSA8LSBhY2N1bXVsYXRlZF9tYXRyaXgKCmFjY19yYW5rIDwtIHJhbmtpbmdfYWNjdW11bGF0ZWRbLCBjKDEsbmNvbChyYW5raW5nX2FjY3VtdWxhdGVkKSldIHw+IAogIHJlbmFtZShhY2NfcmFuayA9IGNvbG5hbWVzKHJhbmtpbmdfYWNjdW11bGF0ZWQpW25jb2wocmFua2luZ19hY2N1bXVsYXRlZCldKSB8PgogIGFycmFuZ2UoZGVzYyhhY2NfcmFuaykpCgoKIyBBdWdtZW50IHRoZSByYW5rcyB3aXRoIGluZm8KYXVnX2FjY19yYW5rIDwtIGFjY19yYW5rIHw+CiAgaW5uZXJfam9pbihpbmZvX29mX3Rob3NlX3RoYXRfcGFzc2VkX2FsbF9maWx0ZXJzLCBieSA9ICJzeW1ib2wiKSB8PgogIGFycmFuZ2UoZGVzYyhhY2NfcmFuaykpIHw+CiAgc2VsZWN0KHN5bWJvbCwgYWNjX3JhbmssIG1hcmtldENhcCwgbWFya2V0Q2FwXywgYWNjdW1fcGN0X2NoYW5nZSwgY291bnRyeSwgaW5kdXN0cnksIHNlY3RvciwgaXBveWVhciwgdm9sdW1lLCBsYXN0c2FsZSwgbmFtZSkgfD4KICBtdXRhdGUocmFuayA9IHJvd19udW1iZXIoKSkgfD4KICBtdXRhdGUoc3ltYm9sID0gcGFzdGUwKCI8YSBocmVmPSdodHRwczovL2ZpbmFuY2UueWFob28uY29tL3F1b3RlLyIsIHN5bWJvbCwgIicgdGFyZ2V0PSdfYmxhbmsnPiIsIHN5bWJvbCwgIjwvYT4iKSkgfD4KICBzZWxlY3Qoc3ltYm9sLCBhY2NfcmFuaywgbWFya2V0Q2FwLCBtYXJrZXRDYXBfLCBhY2N1bV9wY3RfY2hhbmdlLCBjb3VudHJ5LCBpbmR1c3RyeSwgc2VjdG9yLCBpcG95ZWFyLCB2b2x1bWUsIHJhbmssIGxhc3RzYWxlLCBuYW1lKQoKCmF1Z19zdW1fcmFuayA8LSBzdW1fcmFuayB8PgogIGlubmVyX2pvaW4oaW5mb19vZl90aG9zZV90aGF0X3Bhc3NlZF9hbGxfZmlsdGVycywgYnkgPSAic3ltYm9sIikgfD4KICBhcnJhbmdlKGRlc2Moc3VtX3JhbmspKSB8PgogIHNlbGVjdChzeW1ib2wsIHN1bV9yYW5rLCBtYXJrZXRDYXAsIG1hcmtldENhcF8sIGFjY3VtX3BjdF9jaGFuZ2UsIGNvdW50cnksIGluZHVzdHJ5LCBzZWN0b3IsIGlwb3llYXIsIHZvbHVtZSwgbGFzdHNhbGUsIG5hbWUpIHw+CiAgbXV0YXRlKHJhbmsgPSByb3dfbnVtYmVyKCkpIHw+CiAgbXV0YXRlKHN5bWJvbCA9IHBhc3RlMCgiPGEgaHJlZj0naHR0cHM6Ly9maW5hbmNlLnlhaG9vLmNvbS9xdW90ZS8iLCBzeW1ib2wsICInIHRhcmdldD0nX2JsYW5rJz4iLCBzeW1ib2wsICI8L2E+IikpIHw+CiAgc2VsZWN0KHN5bWJvbCwgc3VtX3JhbmssIG1hcmtldENhcCwgbWFya2V0Q2FwXywgYWNjdW1fcGN0X2NoYW5nZSwgY291bnRyeSwgaW5kdXN0cnksIHNlY3RvciwgaXBveWVhciwgdm9sdW1lLCByYW5rLCBsYXN0c2FsZSwgbmFtZSkKCmF1Z19sYXN0X2RheV9yYW5rIDwtIGxhc3RfZGF5X3JhbmsgfD4KICBpbm5lcl9qb2luKGluZm9fb2ZfdGhvc2VfdGhhdF9wYXNzZWRfYWxsX2ZpbHRlcnMsIGJ5ID0gInN5bWJvbCIpIHw+CiAgYXJyYW5nZShkZXNjKGxhc3RfcmFuaykpIHw+CiAgc2VsZWN0KHN5bWJvbCwgbGFzdF9yYW5rLCBtYXJrZXRDYXAsIG1hcmtldENhcF8sIGFjY3VtX3BjdF9jaGFuZ2UsIGNvdW50cnksIGluZHVzdHJ5LCBzZWN0b3IsIGlwb3llYXIsIHZvbHVtZSwgbGFzdHNhbGUsIG5hbWUpIHw+CiAgbXV0YXRlKHJhbmsgPSByb3dfbnVtYmVyKCkpIHw+CiAgbXV0YXRlKHN5bWJvbCA9IHBhc3RlMCgiPGEgaHJlZj0naHR0cHM6Ly9maW5hbmNlLnlhaG9vLmNvbS9xdW90ZS8iLCBzeW1ib2wsICInIHRhcmdldD0nX2JsYW5rJz4iLCBzeW1ib2wsICI8L2E+IikpIHw+CiAgc2VsZWN0KHN5bWJvbCwgbGFzdF9yYW5rLCBtYXJrZXRDYXAsIG1hcmtldENhcF8sIGFjY3VtX3BjdF9jaGFuZ2UsIGNvdW50cnksIGluZHVzdHJ5LCBzZWN0b3IsIGlwb3llYXIsIHZvbHVtZSwgcmFuaywgbGFzdHNhbGUsIG5hbWUpCmBgYAoKKioqKioqKioqKioqKioqCgojIEFjY3VtdWxhdGVkIFJhbmsKCioqKioqKioqKioqKioqKgoKCgpgYGB7ciByZXN1bHRzPSdhc2lzJ30KZGF0YXRhYmxlKAogIGF1Z19hY2NfcmFuaywKICBmaWx0ZXIgPSAnbm9uZScsCiAgb3B0aW9ucyA9IGxpc3QoCiAgICBwYWdlTGVuZ3RoID0gMTAsCiAgICBhdXRvV2lkdGggPSBUUlVFLAogICAgZG9tID0gJ2xydGlwJywKICAgIGluaXRDb21wbGV0ZSA9IEpTKAogICJmdW5jdGlvbihzZXR0aW5ncykgeyIsCiAgIiAgdmFyIGFwaSA9IHRoaXMuYXBpKCk7IiwKICAiICB2YXIgaGVhZGVyID0gJChhcGkudGFibGUoKS5oZWFkZXIoKSk7IiwKICAiICB2YXIgZmlsdGVyUm93ID0gJCgnPHRyPicpLmFwcGVuZFRvKGhlYWRlcik7IiwKCiAgIiAgdmFyIGNvbEluZGljZXMgPSB7IGNvdW50cnk6IDUsIGluZHVzdHJ5OiA2LCBzZWN0b3I6IDcsIGlwb3llYXI6IDggfTsiLAogICIgIHZhciBpbmR1c3RyeVRvU2VjdG9yID0ge307IiwKCiAgIiAgLy8gRmlyc3QgcGFzczogYnVpbGQgaW5kdXN0cnktdG8tc2VjdG9yIG1hcCIsCiAgIiAgdmFyIGFsbERhdGEgPSBhcGkucm93cygpLmRhdGEoKTsiLAogICIgIGFsbERhdGEuZWFjaChmdW5jdGlvbihyb3cpIHsiLAogICIgICAgdmFyIGluZHVzdHJ5ID0gcm93W2NvbEluZGljZXMuaW5kdXN0cnldOyIsCiAgIiAgICB2YXIgc2VjdG9yID0gcm93W2NvbEluZGljZXMuc2VjdG9yXTsiLAogICIgICAgaWYgKGluZHVzdHJ5ICYmIHNlY3RvcikgeyIsCiAgIiAgICAgIGluZHVzdHJ5VG9TZWN0b3JbaW5kdXN0cnldID0gc2VjdG9yOyIsCiAgIiAgICB9IiwKICAiICB9KTsiLAoKICAiICBhcGkuY29sdW1ucygpLmV2ZXJ5KGZ1bmN0aW9uKGluZGV4KSB7IiwKICAiICAgIHZhciBjb2x1bW4gPSB0aGlzOyIsCiAgIiAgICB2YXIgY2VsbCA9ICQoJzx0aD4nKS5hcHBlbmRUbyhmaWx0ZXJSb3cpOyIsCgogICIgICAgaWYgKFtjb2xJbmRpY2VzLmNvdW50cnksIGNvbEluZGljZXMuaW5kdXN0cnksIGNvbEluZGljZXMuc2VjdG9yLCBjb2xJbmRpY2VzLmlwb3llYXJdLmluY2x1ZGVzKGluZGV4KSkgeyIsCiAgIiAgICAgIHZhciBzZWxlY3QgPSAkKCc8c2VsZWN0PjxvcHRpb24gdmFsdWU9XCJcIj48L29wdGlvbj48L3NlbGVjdD4nKSIsCiAgIiAgICAgICAgLmFwcGVuZFRvKGNlbGwpIiwKICAiICAgICAgICAub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkgeyIsCiAgIiAgICAgICAgICB2YXIgdmFsID0gJC5mbi5kYXRhVGFibGUudXRpbC5lc2NhcGVSZWdleCgkKHRoaXMpLnZhbCgpKTsiLAogICIgICAgICAgICAgY29sdW1uLnNlYXJjaCh2YWwgPyAnXicgKyB2YWwgKyAnJCcgOiAnJywgdHJ1ZSwgZmFsc2UpLmRyYXcoKTsiLAoKICAiICAgICAgICAgIGlmIChpbmRleCA9PT0gY29sSW5kaWNlcy5zZWN0b3IpIHsiLAogICIgICAgICAgICAgICB2YXIgc2VsZWN0ZWRTZWN0b3IgPSAkKHRoaXMpLnZhbCgpOyIsCiAgIiAgICAgICAgICAgIHZhciBpbmR1c3RyeVNlbGVjdCA9IGZpbHRlclJvdy5maW5kKCd0aCcpLmVxKGNvbEluZGljZXMuaW5kdXN0cnkpLmZpbmQoJ3NlbGVjdCcpOyIsCiAgIiAgICAgICAgICAgIGluZHVzdHJ5U2VsZWN0LnZhbCgnJyk7IC8vIGNsZWFyIHNlbGVjdGlvbiIsCiAgIiAgICAgICAgICAgIGluZHVzdHJ5U2VsZWN0LmVtcHR5KCkuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPVwiXCI+PC9vcHRpb24+Jyk7IiwKICAiICAgICAgICAgICAgdmFyIGluZHVzdHJpZXMgPSBPYmplY3Qua2V5cyhpbmR1c3RyeVRvU2VjdG9yKS5maWx0ZXIoZnVuY3Rpb24oaW5kKSB7IiwKICAiICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRTZWN0b3IgPT09ICcnIHx8IGluZHVzdHJ5VG9TZWN0b3JbaW5kXSA9PT0gc2VsZWN0ZWRTZWN0b3I7IiwKICAiICAgICAgICAgICAgfSkuc29ydCgpOyIsCiAgIiAgICAgICAgICAgIGluZHVzdHJpZXMuZm9yRWFjaChmdW5jdGlvbihpbmQpIHsiLAogICIgICAgICAgICAgICAgIGluZHVzdHJ5U2VsZWN0LmFwcGVuZCgnPG9wdGlvbiB2YWx1ZT1cIicgKyBpbmQgKyAnXCI+JyArIGluZCArICc8L29wdGlvbj4nKTsiLAogICIgICAgICAgICAgICB9KTsiLAogICIgICAgICAgICAgICAvLyBBbHNvIGNsZWFyIGluZHVzdHJ5IGZpbHRlciB3aGVuIHNlY3RvciBpcyByZXNldCIsCiAgIiAgICAgICAgICAgIHZhciBpbmR1c3RyeUNvbHVtbiA9IGFwaS5jb2x1bW4oY29sSW5kaWNlcy5pbmR1c3RyeSk7IiwKICAiICAgICAgICAgICAgaW5kdXN0cnlDb2x1bW4uc2VhcmNoKCcnLCB0cnVlLCBmYWxzZSkuZHJhdygpOyIsCiAgIiAgICAgICAgICB9IiwKICAiICAgICAgICB9KTsiLAoKICAiICAgICAgY29sdW1uLmRhdGEoKS51bmlxdWUoKS5zb3J0KCkuZWFjaChmdW5jdGlvbihkKSB7IiwKICAiICAgICAgICBzZWxlY3QuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPVwiJyArIGQgKyAnXCI+JyArIGQgKyAnPC9vcHRpb24+Jyk7IiwKICAiICAgICAgfSk7IiwKICAiICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IDApIHsiLAogICIgICAgICAvLyBBZGQgdGV4dCBpbnB1dCBmb3Igc3ltYm9sIHNlYXJjaCIsCiAgIiAgICAgICQoJzxpbnB1dCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiU2VhcmNoIHN5bWJvbFwiIHN0eWxlPVwid2lkdGg6IDEwMCU7XCI+JykiLAogICIgICAgICAgIC5hcHBlbmRUbyhjZWxsKSIsCiAgIiAgICAgICAgLm9uKCdrZXl1cCBjaGFuZ2UnLCBmdW5jdGlvbigpIHsiLAogICIgICAgICAgICAgdmFyIHZhbCA9ICQodGhpcykudmFsKCk7IiwKICAiICAgICAgICAgIGNvbHVtbi5zZWFyY2godmFsKS5kcmF3KCk7IiwKICAiICAgICAgICB9KTsiLAogICIgICAgfSBlbHNlIHsiLAogICIgICAgICAkKGNlbGwpLmh0bWwoJycpOyIsCiAgIiAgICB9IiwKICAiICB9KTsiLAogICJ9IgopCiAgKSwKICBlc2NhcGUgPSBGQUxTRSwKICByb3duYW1lcyA9IEZBTFNFLAogIGNsYXNzID0gImRpc3BsYXkgbm93cmFwIgopCgoKYGBgCgoKCioqKioqKioqKioqKioqKgoKIyBTdW0gb2YgUmFua3MKCioqKioqKioqKioqKioqKgoKYGBge3J9CmRhdGF0YWJsZSgKICBhdWdfc3VtX3JhbmssCiAgZmlsdGVyID0gJ25vbmUnLAogIG9wdGlvbnMgPSBsaXN0KAogICAgcGFnZUxlbmd0aCA9IDEwLAogICAgYXV0b1dpZHRoID0gVFJVRSwKICAgIGRvbSA9ICdscnRpcCcsCiAgICBpbml0Q29tcGxldGUgPSBKUygKICAiZnVuY3Rpb24oc2V0dGluZ3MpIHsiLAogICIgIHZhciBhcGkgPSB0aGlzLmFwaSgpOyIsCiAgIiAgdmFyIGhlYWRlciA9ICQoYXBpLnRhYmxlKCkuaGVhZGVyKCkpOyIsCiAgIiAgdmFyIGZpbHRlclJvdyA9ICQoJzx0cj4nKS5hcHBlbmRUbyhoZWFkZXIpOyIsCgogICIgIHZhciBjb2xJbmRpY2VzID0geyBjb3VudHJ5OiA1LCBpbmR1c3RyeTogNiwgc2VjdG9yOiA3LCBpcG95ZWFyOiA4IH07IiwKICAiICB2YXIgaW5kdXN0cnlUb1NlY3RvciA9IHt9OyIsCgogICIgIC8vIEZpcnN0IHBhc3M6IGJ1aWxkIGluZHVzdHJ5LXRvLXNlY3RvciBtYXAiLAogICIgIHZhciBhbGxEYXRhID0gYXBpLnJvd3MoKS5kYXRhKCk7IiwKICAiICBhbGxEYXRhLmVhY2goZnVuY3Rpb24ocm93KSB7IiwKICAiICAgIHZhciBpbmR1c3RyeSA9IHJvd1tjb2xJbmRpY2VzLmluZHVzdHJ5XTsiLAogICIgICAgdmFyIHNlY3RvciA9IHJvd1tjb2xJbmRpY2VzLnNlY3Rvcl07IiwKICAiICAgIGlmIChpbmR1c3RyeSAmJiBzZWN0b3IpIHsiLAogICIgICAgICBpbmR1c3RyeVRvU2VjdG9yW2luZHVzdHJ5XSA9IHNlY3RvcjsiLAogICIgICAgfSIsCiAgIiAgfSk7IiwKCiAgIiAgYXBpLmNvbHVtbnMoKS5ldmVyeShmdW5jdGlvbihpbmRleCkgeyIsCiAgIiAgICB2YXIgY29sdW1uID0gdGhpczsiLAogICIgICAgdmFyIGNlbGwgPSAkKCc8dGg+JykuYXBwZW5kVG8oZmlsdGVyUm93KTsiLAoKICAiICAgIGlmIChbY29sSW5kaWNlcy5jb3VudHJ5LCBjb2xJbmRpY2VzLmluZHVzdHJ5LCBjb2xJbmRpY2VzLnNlY3RvciwgY29sSW5kaWNlcy5pcG95ZWFyXS5pbmNsdWRlcyhpbmRleCkpIHsiLAogICIgICAgICB2YXIgc2VsZWN0ID0gJCgnPHNlbGVjdD48b3B0aW9uIHZhbHVlPVwiXCI+PC9vcHRpb24+PC9zZWxlY3Q+JykiLAogICIgICAgICAgIC5hcHBlbmRUbyhjZWxsKSIsCiAgIiAgICAgICAgLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsiLAogICIgICAgICAgICAgdmFyIHZhbCA9ICQuZm4uZGF0YVRhYmxlLnV0aWwuZXNjYXBlUmVnZXgoJCh0aGlzKS52YWwoKSk7IiwKICAiICAgICAgICAgIGNvbHVtbi5zZWFyY2godmFsID8gJ14nICsgdmFsICsgJyQnIDogJycsIHRydWUsIGZhbHNlKS5kcmF3KCk7IiwKCiAgIiAgICAgICAgICBpZiAoaW5kZXggPT09IGNvbEluZGljZXMuc2VjdG9yKSB7IiwKICAiICAgICAgICAgICAgdmFyIHNlbGVjdGVkU2VjdG9yID0gJCh0aGlzKS52YWwoKTsiLAogICIgICAgICAgICAgICB2YXIgaW5kdXN0cnlTZWxlY3QgPSBmaWx0ZXJSb3cuZmluZCgndGgnKS5lcShjb2xJbmRpY2VzLmluZHVzdHJ5KS5maW5kKCdzZWxlY3QnKTsiLAogICIgICAgICAgICAgICBpbmR1c3RyeVNlbGVjdC52YWwoJycpOyAvLyBjbGVhciBzZWxlY3Rpb24iLAogICIgICAgICAgICAgICBpbmR1c3RyeVNlbGVjdC5lbXB0eSgpLmFwcGVuZCgnPG9wdGlvbiB2YWx1ZT1cIlwiPjwvb3B0aW9uPicpOyIsCiAgIiAgICAgICAgICAgIHZhciBpbmR1c3RyaWVzID0gT2JqZWN0LmtleXMoaW5kdXN0cnlUb1NlY3RvcikuZmlsdGVyKGZ1bmN0aW9uKGluZCkgeyIsCiAgIiAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkU2VjdG9yID09PSAnJyB8fCBpbmR1c3RyeVRvU2VjdG9yW2luZF0gPT09IHNlbGVjdGVkU2VjdG9yOyIsCiAgIiAgICAgICAgICAgIH0pLnNvcnQoKTsiLAogICIgICAgICAgICAgICBpbmR1c3RyaWVzLmZvckVhY2goZnVuY3Rpb24oaW5kKSB7IiwKICAiICAgICAgICAgICAgICBpbmR1c3RyeVNlbGVjdC5hcHBlbmQoJzxvcHRpb24gdmFsdWU9XCInICsgaW5kICsgJ1wiPicgKyBpbmQgKyAnPC9vcHRpb24+Jyk7IiwKICAiICAgICAgICAgICAgfSk7IiwKICAiICAgICAgICAgICAgLy8gQWxzbyBjbGVhciBpbmR1c3RyeSBmaWx0ZXIgd2hlbiBzZWN0b3IgaXMgcmVzZXQiLAogICIgICAgICAgICAgICB2YXIgaW5kdXN0cnlDb2x1bW4gPSBhcGkuY29sdW1uKGNvbEluZGljZXMuaW5kdXN0cnkpOyIsCiAgIiAgICAgICAgICAgIGluZHVzdHJ5Q29sdW1uLnNlYXJjaCgnJywgdHJ1ZSwgZmFsc2UpLmRyYXcoKTsiLAogICIgICAgICAgICAgfSIsCiAgIiAgICAgICAgfSk7IiwKCiAgIiAgICAgIGNvbHVtbi5kYXRhKCkudW5pcXVlKCkuc29ydCgpLmVhY2goZnVuY3Rpb24oZCkgeyIsCiAgIiAgICAgICAgc2VsZWN0LmFwcGVuZCgnPG9wdGlvbiB2YWx1ZT1cIicgKyBkICsgJ1wiPicgKyBkICsgJzwvb3B0aW9uPicpOyIsCiAgIiAgICAgIH0pOyIsCiAgIiAgICB9IGVsc2UgaWYgKGluZGV4ID09PSAwKSB7IiwKICAiICAgICAgLy8gQWRkIHRleHQgaW5wdXQgZm9yIHN5bWJvbCBzZWFyY2giLAogICIgICAgICAkKCc8aW5wdXQgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIlNlYXJjaCBzeW1ib2xcIiBzdHlsZT1cIndpZHRoOiAxMDAlO1wiPicpIiwKICAiICAgICAgICAuYXBwZW5kVG8oY2VsbCkiLAogICIgICAgICAgIC5vbigna2V5dXAgY2hhbmdlJywgZnVuY3Rpb24oKSB7IiwKICAiICAgICAgICAgIHZhciB2YWwgPSAkKHRoaXMpLnZhbCgpOyIsCiAgIiAgICAgICAgICBjb2x1bW4uc2VhcmNoKHZhbCkuZHJhdygpOyIsCiAgIiAgICAgICAgfSk7IiwKICAiICAgIH0gZWxzZSB7IiwKICAiICAgICAgJChjZWxsKS5odG1sKCcnKTsiLAogICIgICAgfSIsCiAgIiAgfSk7IiwKICAifSIKKQogICksCiAgZXNjYXBlID0gRkFMU0UsCiAgcm93bmFtZXMgPSBGQUxTRSwKICBjbGFzcyA9ICJkaXNwbGF5IG5vd3JhcCIKKQoKCmBgYAoKKioqKioqKioqKioqKioqCgojIExhc3QgRGF5IFJhbmsKCioqKioqKioqKioqKioqKgoKYGBge3J9CmRhdGF0YWJsZSgKICBhdWdfbGFzdF9kYXlfcmFuaywKICBmaWx0ZXIgPSAnbm9uZScsCiAgb3B0aW9ucyA9IGxpc3QoCiAgICBwYWdlTGVuZ3RoID0gMTAsCiAgICBhdXRvV2lkdGggPSBUUlVFLAogICAgZG9tID0gJ2xydGlwJywKICAgIGluaXRDb21wbGV0ZSA9IEpTKAogICJmdW5jdGlvbihzZXR0aW5ncykgeyIsCiAgIiAgdmFyIGFwaSA9IHRoaXMuYXBpKCk7IiwKICAiICB2YXIgaGVhZGVyID0gJChhcGkudGFibGUoKS5oZWFkZXIoKSk7IiwKICAiICB2YXIgZmlsdGVyUm93ID0gJCgnPHRyPicpLmFwcGVuZFRvKGhlYWRlcik7IiwKCiAgIiAgdmFyIGNvbEluZGljZXMgPSB7IGNvdW50cnk6IDUsIGluZHVzdHJ5OiA2LCBzZWN0b3I6IDcsIGlwb3llYXI6IDggfTsiLAogICIgIHZhciBpbmR1c3RyeVRvU2VjdG9yID0ge307IiwKCiAgIiAgLy8gRmlyc3QgcGFzczogYnVpbGQgaW5kdXN0cnktdG8tc2VjdG9yIG1hcCIsCiAgIiAgdmFyIGFsbERhdGEgPSBhcGkucm93cygpLmRhdGEoKTsiLAogICIgIGFsbERhdGEuZWFjaChmdW5jdGlvbihyb3cpIHsiLAogICIgICAgdmFyIGluZHVzdHJ5ID0gcm93W2NvbEluZGljZXMuaW5kdXN0cnldOyIsCiAgIiAgICB2YXIgc2VjdG9yID0gcm93W2NvbEluZGljZXMuc2VjdG9yXTsiLAogICIgICAgaWYgKGluZHVzdHJ5ICYmIHNlY3RvcikgeyIsCiAgIiAgICAgIGluZHVzdHJ5VG9TZWN0b3JbaW5kdXN0cnldID0gc2VjdG9yOyIsCiAgIiAgICB9IiwKICAiICB9KTsiLAoKICAiICBhcGkuY29sdW1ucygpLmV2ZXJ5KGZ1bmN0aW9uKGluZGV4KSB7IiwKICAiICAgIHZhciBjb2x1bW4gPSB0aGlzOyIsCiAgIiAgICB2YXIgY2VsbCA9ICQoJzx0aD4nKS5hcHBlbmRUbyhmaWx0ZXJSb3cpOyIsCgogICIgICAgaWYgKFtjb2xJbmRpY2VzLmNvdW50cnksIGNvbEluZGljZXMuaW5kdXN0cnksIGNvbEluZGljZXMuc2VjdG9yLCBjb2xJbmRpY2VzLmlwb3llYXJdLmluY2x1ZGVzKGluZGV4KSkgeyIsCiAgIiAgICAgIHZhciBzZWxlY3QgPSAkKCc8c2VsZWN0PjxvcHRpb24gdmFsdWU9XCJcIj48L29wdGlvbj48L3NlbGVjdD4nKSIsCiAgIiAgICAgICAgLmFwcGVuZFRvKGNlbGwpIiwKICAiICAgICAgICAub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkgeyIsCiAgIiAgICAgICAgICB2YXIgdmFsID0gJC5mbi5kYXRhVGFibGUudXRpbC5lc2NhcGVSZWdleCgkKHRoaXMpLnZhbCgpKTsiLAogICIgICAgICAgICAgY29sdW1uLnNlYXJjaCh2YWwgPyAnXicgKyB2YWwgKyAnJCcgOiAnJywgdHJ1ZSwgZmFsc2UpLmRyYXcoKTsiLAoKICAiICAgICAgICAgIGlmIChpbmRleCA9PT0gY29sSW5kaWNlcy5zZWN0b3IpIHsiLAogICIgICAgICAgICAgICB2YXIgc2VsZWN0ZWRTZWN0b3IgPSAkKHRoaXMpLnZhbCgpOyIsCiAgIiAgICAgICAgICAgIHZhciBpbmR1c3RyeVNlbGVjdCA9IGZpbHRlclJvdy5maW5kKCd0aCcpLmVxKGNvbEluZGljZXMuaW5kdXN0cnkpLmZpbmQoJ3NlbGVjdCcpOyIsCiAgIiAgICAgICAgICAgIGluZHVzdHJ5U2VsZWN0LnZhbCgnJyk7IC8vIGNsZWFyIHNlbGVjdGlvbiIsCiAgIiAgICAgICAgICAgIGluZHVzdHJ5U2VsZWN0LmVtcHR5KCkuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPVwiXCI+PC9vcHRpb24+Jyk7IiwKICAiICAgICAgICAgICAgdmFyIGluZHVzdHJpZXMgPSBPYmplY3Qua2V5cyhpbmR1c3RyeVRvU2VjdG9yKS5maWx0ZXIoZnVuY3Rpb24oaW5kKSB7IiwKICAiICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRTZWN0b3IgPT09ICcnIHx8IGluZHVzdHJ5VG9TZWN0b3JbaW5kXSA9PT0gc2VsZWN0ZWRTZWN0b3I7IiwKICAiICAgICAgICAgICAgfSkuc29ydCgpOyIsCiAgIiAgICAgICAgICAgIGluZHVzdHJpZXMuZm9yRWFjaChmdW5jdGlvbihpbmQpIHsiLAogICIgICAgICAgICAgICAgIGluZHVzdHJ5U2VsZWN0LmFwcGVuZCgnPG9wdGlvbiB2YWx1ZT1cIicgKyBpbmQgKyAnXCI+JyArIGluZCArICc8L29wdGlvbj4nKTsiLAogICIgICAgICAgICAgICB9KTsiLAogICIgICAgICAgICAgICAvLyBBbHNvIGNsZWFyIGluZHVzdHJ5IGZpbHRlciB3aGVuIHNlY3RvciBpcyByZXNldCIsCiAgIiAgICAgICAgICAgIHZhciBpbmR1c3RyeUNvbHVtbiA9IGFwaS5jb2x1bW4oY29sSW5kaWNlcy5pbmR1c3RyeSk7IiwKICAiICAgICAgICAgICAgaW5kdXN0cnlDb2x1bW4uc2VhcmNoKCcnLCB0cnVlLCBmYWxzZSkuZHJhdygpOyIsCiAgIiAgICAgICAgICB9IiwKICAiICAgICAgICB9KTsiLAoKICAiICAgICAgY29sdW1uLmRhdGEoKS51bmlxdWUoKS5zb3J0KCkuZWFjaChmdW5jdGlvbihkKSB7IiwKICAiICAgICAgICBzZWxlY3QuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPVwiJyArIGQgKyAnXCI+JyArIGQgKyAnPC9vcHRpb24+Jyk7IiwKICAiICAgICAgfSk7IiwKICAiICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IDApIHsiLAogICIgICAgICAvLyBBZGQgdGV4dCBpbnB1dCBmb3Igc3ltYm9sIHNlYXJjaCIsCiAgIiAgICAgICQoJzxpbnB1dCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiU2VhcmNoIHN5bWJvbFwiIHN0eWxlPVwid2lkdGg6IDEwMCU7XCI+JykiLAogICIgICAgICAgIC5hcHBlbmRUbyhjZWxsKSIsCiAgIiAgICAgICAgLm9uKCdrZXl1cCBjaGFuZ2UnLCBmdW5jdGlvbigpIHsiLAogICIgICAgICAgICAgdmFyIHZhbCA9ICQodGhpcykudmFsKCk7IiwKICAiICAgICAgICAgIGNvbHVtbi5zZWFyY2godmFsKS5kcmF3KCk7IiwKICAiICAgICAgICB9KTsiLAogICIgICAgfSBlbHNlIHsiLAogICIgICAgICAkKGNlbGwpLmh0bWwoJycpOyIsCiAgIiAgICB9IiwKICAiICB9KTsiLAogICJ9IgopCiAgKSwKICBlc2NhcGUgPSBGQUxTRSwKICByb3duYW1lcyA9IEZBTFNFLAogIGNsYXNzID0gImRpc3BsYXkgbm93cmFwIgopCgpgYGAKCioqKioqKioqKioqKioqKgoKIyBSZWFzb24gZm9yIHJhbmtpbmcgZGlzbWlzc2FsCgoqKioqKioqKioqKioqKioKCmBgYHtyfQpkYXRhdGFibGUoCiAgcmVhc29uX2Zvcl90aG9zZV90aGF0X2RpZF9ub3RfcGFzc19hbGxfZmlsdGVycywKICBmaWx0ZXIgPSAidG9wIiwgICAgICAgICAjIFNob3cgZmlsdGVyIGJveGVzIG9uIHRvcCBvZiB0aGUgY29sdW1ucwogIG9wdGlvbnMgPSBsaXN0KAogICAgcGFnZUxlbmd0aCA9IDUsCiAgICBhdXRvV2lkdGggPSBUUlVFLAogICAgY29sdW1uRGVmcyA9IGxpc3QoCiAgICAgIGxpc3QodGFyZ2V0cyA9IDEsIHNlYXJjaGFibGUgPSBUUlVFKSAgIyBEaXNhYmxlIHNlYXJjaCBvbiB0aGUgJ2NvbW1lbnQnIGNvbHVtbgogICAgKQogICkKKQpgYGAKCgoKYGBge3J9CnJhbmdlX29mX2FuYWx5c2lzIDwtcmFuZ2Uoc3RvY2tfZGF0YV90b19zYXZlJGRhdGUpCnByaW50KHBhc3RlKCJUaGlzIHdhcyBleGVjdXRlZCBvbjoiLCBTeXMudGltZSgpLCAKICAgICAgICAgICAgImFuZCB0aGUgcmFuZ2Ugb2YgYW5hbHlzaXMgaXMgZnJvbSIsIAogICAgICAgICAgICByYW5nZV9vZl9hbmFseXNpc1sxXSwgCiAgICAgICAgICAgICJ0byIsIAogICAgICAgICAgICByYW5nZV9vZl9hbmFseXNpc1syXSkpCmBgYAoKCmBgYHtyfQpzbGFja3JfbXNnKAogIHRleHQgPSAiTmV3IHVwZGF0ZSBhdCA8aHR0cHM6Ly9sZW5pbnJhZmFlbHJpZXJhc2VndXJhLmdpdGh1Yi5pby9BbHBhY2EvaW5mby5odG1sPiIsCiAgY2hhbm5lbCA9ICIjcmFua3MiCikKYGBgCgoKYGBge3J9CmNpdGVfcGFja2FnZXMob3V0cHV0ID0gInBhcmFncmFwaCIsIG91dC5kaXIgPSAiLiIpCmBgYAo=</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("info.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
